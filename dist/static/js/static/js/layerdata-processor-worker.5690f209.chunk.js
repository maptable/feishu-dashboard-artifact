(()=>{"use strict";var e={46131:(e,i,t)=>{t.d(i,{IG:()=>I,fi:()=>y,uT:()=>h,yK:()=>g});var n=t(74720),o=t.n(n),l=(t(7070),t(75538)),r=t.n(l),a=t(78587),d=t.n(a),s=t(75091),u=t.n(s),c=t(99540),p=t.n(c),f=(t(81659),t(21740),t(91671),t(42015),t(97102)),v=t.n(f);const m=201;function h(e,i){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m;const n=v()(e.slice(0,t),(e=>{const t=b(e,i);return d()(t)?r()(t,","):u()(t)?t.id:t}));return delete n[void 0],delete n.null,delete n[""],Object.keys(n).filter((e=>e)).sort(((e,i)=>e.length!==i.length?e.length-i.length:e.localeCompare(i)))}function y(e,i){if(!e||null===i||void 0===i||!i.textQuantiles)return;const t=i.textQuantiles[e.id];return t?Object.keys(t):void 0}function g(e,i,t){var n,o,l,r,a;if(!e)return;if(!t||null===i||void 0===i||null===(n=i.metadata)||void 0===n||!n.quantiles)return null===i||void 0===i||null===(o=i.quantiles)||void 0===o?void 0:o[e.id];const d=i.metadata.quantiles[t];return d?null!==(r=d[e.id])&&void 0!==r?r:null===i||void 0===i||null===(a=i.quantiles)||void 0===a?void 0:a[e.id]:null===i||void 0===i||null===(l=i.quantiles)||void 0===l?void 0:l[e.id]}function b(e,i){return o()(null===e||void 0===e?void 0:e.properties,null!==i&&void 0!==i?i:"")}function I(e){return function(e){const i=[{value:1e9,symbol:"b"},{value:1e6,symbol:"m"},{value:1e3,symbol:"k"}];if(e<1e3)return e.toString();for(const t of i)if(e>=t.value){const i=e/t.value,n=Math.floor(i).toString().length,o=Math.max(0,4-n);return i.toFixed(o).replace(/\.?0+$/,"")+t.symbol}return e.toString()}(function(e){if(0!==e&&e>-.1&&e<1){let i,t=e;for(i=0;i<10&&t>-.1&&t<1;i++)t*=10;return parseFloat(e.toFixed(i+2))}return parseFloat(p()(e).toFixed(3))}(e))}},91671:(e,i,t)=>{t.d(i,{P:()=>o});const n={CNY:"zh-CN",USD:"en-US",EUR:"de-DE",GBP:"en-GB",AED:"ar-AE",AUD:"en-AU",BRL:"pt-BR",CAD:"en-CA",CHF:"de-CH",HKD:"zh-HK",INR:"en-IN",IDR:"id-ID",JPY:"ja-JP",KRW:"ko-KR",MOP:"zh-MO",MXN:"es-MX",MYR:"ms-MY",PHP:"en-PH",PLN:"pl-PL",RUB:"ru-RU",SGD:"en-SG",THB:"th-TH",TRY:"tr-TR",TWD:"zh-TW",VND:"vi-VN"};function o(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"number",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"USD";const l={minimumFractionDigits:i,maximumFractionDigits:i,useGrouping:"commaNumber"===t||"currency"===t,notation:(arguments.length>4?arguments[4]:void 0)?"compact":"standard"};if(null===e||"undefined"===typeof e||Number.isNaN(e))return;var r;if(String(e).toUpperCase().includes("E"))return null===e||void 0===e||null===(r=e.toExponential)||void 0===r?void 0:r.call(e,0===i?0:i-1);const a="currency"===t;if("percentage"===t)return(100*e).toLocaleString(void 0,l)+"%";if(a){const i=n[o]||"en-US";return e.toLocaleString(i,{...l,style:"currency",currency:o})}return"number"===typeof e?e.toLocaleString("en-US",l):e}},3669:(e,i,t)=>{var n,o=t(78062),l=t(43179),r=t.n(l),a=t(53813),d=t.n(a),s=t(23502),u=t.n(s),c=t(18878),p=t.n(c),f=t(48828),v=t(86183),m=t(18263),h=t.n(m),y=t(74933),g=t.n(y),b=t(15288),I=t.n(b),C=t(65066),D=t.n(C),F=t(98968);const k=["maptableGreen1","maptableGreen2","maptablePink1","maptablePink2","maptablePink3","maptableBlue1"],w=["maptableBluePurple","maptableCyanBlack","maptableCyanGray","maptableRdBu"],O=["#E3F2E2","#BDDFD2","#99CDC2","#59A6A8","#3F9392","#267F7E","#086B6D","#00585D","#004548"],M=["#cdfcd7","#a9e4c9","#88cdba","#68b4ac","#499c9e","#35848d","#216d7d","#13546a","#073e58"],T=["#fff8bb","#ffe5a8","#ffd297","#ffbd89","#ffa87f","#ff927c","#ff7d7b","#f6677d","#ea5383"],N=["#f4e9a2","#fccf91","#ffb487","#fc9984","#f38088","#dd6c8f","#be5f98","#94559e","#5e4fa1"],P=["#eefc50","#ffc849","#fe946d","#f16b87","#db4486","#b61d7f","#850092","#520099","#130083"],S=["#59eefb","#4dd6ef","#40bde3","#34a4d7","#278bca","#4566c4","#5a3fbe","#6b0bb8","#7b00b3"],E=["#0083f8","#00a5cc","#00c5a1","#76c26d","#ffbe46","#ffa148","#ff824e","#e04a9f","#b900f8"],L=["#73c2a9","#c7dcc4","#eec4b4","#d46165","#c19280","#a7c39b","#7c6548","#442a1a","#050505"],B=["#55c5cb","#fcbe7b","#e8aad1","#81c679","#d3a0d0","#cfd385","#8dd2b7","#caa9aa","#b3b3b3"],A=["#1a79b3","#56e0c7","#8cc5dd","#bbe1e1","#bdf1d2","#ffffc5","#ffe1a0","#ffc07d","#fc9381","#ef5850","#e0203f"].reverse(),x=(O.length,{maptableGreen1:{3:O.slice(0,3),4:O.slice(0,4),5:O.slice(0,5),6:O.slice(0,6),7:O.slice(0,7),8:O.slice(0,8),9:O.slice(0,9)},maptableGreen2:{3:M.slice(0,3),4:M.slice(0,4),5:M.slice(0,5),6:M.slice(0,6),7:M.slice(0,7),8:M.slice(0,8),9:M.slice(0,9)},maptablePink1:{3:T.slice(0,3),4:T.slice(0,4),5:T.slice(0,5),6:T.slice(0,6),7:T.slice(0,7),8:T.slice(0,8),9:T.slice(0,9)},maptablePink2:{3:N.slice(0,3),4:N.slice(0,4),5:N.slice(0,5),6:N.slice(0,6),7:N.slice(0,7),8:N.slice(0,8),9:N.slice(0,9)},maptablePink3:{3:P.slice(0,3),4:P.slice(0,4),5:P.slice(0,5),6:P.slice(0,6),7:P.slice(0,7),8:P.slice(0,8),9:P.slice(0,9)},maptableBlue1:{3:S.slice(0,3),4:S.slice(0,4),5:S.slice(0,5),6:S.slice(0,6),7:S.slice(0,7),8:S.slice(0,8),9:S.slice(0,9)},maptableBluePurple:{3:E.slice(0,3),4:E.slice(0,4),5:E.slice(0,5),6:E.slice(0,6),7:E.slice(0,7),8:E.slice(0,8),9:E.slice(0,9)},maptableCyanBlack:{3:L.slice(0,3),4:L.slice(0,4),5:L.slice(0,5),6:L.slice(0,6),7:L.slice(0,7),8:L.slice(0,8),9:L.slice(0,9)},maptableCyanGray:{3:B.slice(0,3),4:B.slice(0,4),5:B.slice(0,5),6:B.slice(0,6),7:B.slice(0,7),8:B.slice(0,8),9:B.slice(0,9)},maptableRdBu:{3:A.slice(0,3),4:A.slice(0,4),5:A.slice(0,5),6:A.slice(0,6),7:A.slice(0,7),8:A.slice(0,8),9:A.slice(0,9),10:A.slice(0,10),11:A.slice(0,11)}}),R=["#008080","#31968c","#78ac99","#a3c2a6","#cdd8b3","#f7eec1","#f4d1a3","#efb386","#e7966a","#dd7750","#d25836"].reverse(),G=["#009b9d","#00acad","#40bdbd","#8ccdcf","#c2dfe0","#f1f1f1","#ebd4e2","#e5b7d3","#ef9ac4","#d77ab7","#cf5aaa"].reverse(),j={BrBG:{3:R.slice(0,3),4:R.slice(0,4),5:R.slice(0,5),6:R.slice(0,6),7:R.slice(0,7),8:R.slice(0,8),9:R.slice(0,9),10:R.slice(0,10),11:R.slice(0,11)},PiYG:{3:G.slice(0,3),4:G.slice(0,4),5:G.slice(0,5),6:G.slice(0,6),7:G.slice(0,7),8:G.slice(0,8),9:G.slice(0,9),10:G.slice(0,10),11:G.slice(0,11)}},q={...F.Z,...x,...j},{sequential:z=[],singlehue:W=[],diverging:V=[],qualitative:_=[]}=null!==(n=null===F.Z||void 0===F.Z?void 0:F.Z.schemeGroups)&&void 0!==n?n:{},U=["BuGn","PuBu","PuBuGn","PuRd","RdPu","Pastel1","Set3","RdBu"],Y=[...k,...W,...z,...V,..._,...w].filter((e=>!U.includes(e))),H=h()(3,12);function Z(e,i){if(V.includes(e)){var t;const n=null===(t=q[e])||void 0===t?void 0:t[i];return n?[...n].reverse():n}return q[e][i]}I()(g()(H),(e=>D()(I()(g()(Y),(i=>Z(i,e))))));const K=["Set1","Set2","Spectral","YlGn","YlGnBu","YlOrBr","YlOrRd","Accent","Dark2","Paired","Pastel2","maptableCyanBlack","maptableCyanGray"],J=[...k,"Oranges","PRGn","RdYlGn","maptableBluePurple","maptableRdBu"],Q=[...k,"Blues","Purples","Oranges","PRGn","RdYlBu","RdYlGn",...w];I()(g()(H),(e=>D()(I()(g()(Y.filter((e=>J.includes(e)))),(i=>Z(i,e)))))),I()(g()(H),(e=>D()(I()(g()(Y.filter((e=>Q.includes(e)))),(i=>Z(i,e)))))),I()(g()(H),(e=>D()(I()(g()(Y.filter((e=>Q.includes(e)))),(i=>Z(i,e)))))),I()(g()(H),(e=>D()(I()(g()(Y.filter((e=>!K.includes(e)))),(i=>Z(i,e))))));const X={...{redLighter:"#FADADA",salmonLighter:"#FBE7E2",orangeLighter:"#FEF0E3",yellowLighter:"#FFF8E0",greenLighter:"#E7F6F0",cyanLighter:"#E0F6FB",blueLighter:"#E0EDFF",purpleLighter:"#EDEAF8",lilacLighter:"#F6E5FC",greyLighter:"#EDEEF2",redLight:"#F5B6B6",salmonLight:"#F6C6BB",orangeLight:"#FDDCBE",yellowLight:"#FFEFB8",greenLight:"#C7EADB",cyanLight:"#B8EBF4",blueLight:"#B8D4FF",purpleLight:"#D4CFEE",lilacLight:"#EFCFFB",greyLight:"#E1E4EA"},redDark:"#E64C4C",salmonDark:"#E55939",orangeDark:"#F99439",yellowDark:"#FFC80A",greenDark:"#5EC298",cyanDark:"#46CBE2",blueDark:"#3384FF",purpleDark:"#8476CD",lilacDark:"#C043EF",greyDark:"#505F79"};var $=t(37383),ee=t(82086),ie=(t(40517),t(6778),t(27222),t(69820),t(17527),t(67045),t(22787)),te=t(88716),ne=t.n(te);t(52675),t(58205);var oe=t(57323),le=t.n(oe);class re{constructor(e){le()(this,"i",0),this.raw=e}peek(){if(this.i>this.raw.length)throw new Error("unexpected EOF");return this.raw[this.i]}skipWs(){if(!(this.i>=this.raw.length))for(let e=this.i;e<this.raw.length;e++){if(!ae(this.raw.charAt(e)))return;this.i+=1}}scanStart(){this.skipWs();const e=this.peek();if("("!==e)throw new Error("expect '(' got ".concat(e));this.i++}scanContinue(){this.skipWs();const e=this.peek(),i=","===e;if(!i&&")"!==e)throw new Error("expect ',' or ')' got ".concat(e));return this.i++,i}scanCircle(){this.scanStart();const[e,i]=this.scanCoordinate();if(!i){const e=this.peek();throw new Error("expect ',' got ".concat(e))}this.i++,this.skipWs();const t=this.scanNumber(),n=this.peek();if(")"!==n)throw new Error("expect ')' got ".concat(n));return this.i++,[e[0],e[1],t]}scanCirlces(){this.scanStart();const e=[];for(;;){const i=this.scanCircle();e.push(i);if(!this.scanContinue())break}return e}scanNumber(){this.skipWs();let e="",i=this.peek();for(;de(i);)this.i+=1,e+=i,i=this.peek();const t=Number(e);if(Number.isNaN(t))throw new Error("number parse error ".concat(e));return t}scanCoordinate(){if(this.skipWs(),this.i>this.raw.length)throw new Error("unexpected EOF");const e=this.scanNumber();this.skipWs();const i=this.scanNumber();this.skipWs();const t=this.peek(),n=","===t;if(!n&&")"!==t)throw new Error("expect ',' or ')' got ".concat(t));return this.i++,[[e,i],n]}scanCoordinates(e){if(this.scanStart(),e)try{this.scanStart()}catch(t){e=!1}const i=[];for(;;){const[t,n]=this.scanCoordinate();if(i.push(t),!n){if(e){if(this.scanContinue()){this.scanStart();continue}}return i}if(e)throw new Error("expect ')' got ','")}}scanPolyData(e){this.scanStart();const i=[];for(;;){const t=this.scanCoordinates(!1);if(e){if(t.length<4)throw new Error("a polygon ring must have at least 4 points, got ".concat(t.length));if(t[0][0]!==t[t.length-1][0]||t[0][1]!==t[t.length-1][1])throw new Error("a polygon ring must be closed")}else if(t.length<2)throw new Error("must have at least 2 points, got ".concat(t.length));if(i.push(t),!this.scanContinue())return i}}scanMultiPolyData(){this.scanStart();const e=[];for(;;){const i=this.scanPolyData(!0);if(e.push(i),!this.scanContinue())return e}}scanIndent(){if(this.skipWs(),this.i>=this.raw.length)throw new Error("unexpected EOF");let e="",i=0;for(i=this.i;i<this.raw.length;i++){const t=this.raw.charAt(i);if(!se(t))break;e+=t.toUpperCase(),this.i+=1}if(0===e.length)throw new Error("indent not found");return e}scanGeometry(){const e=this.scanIndent();let i;switch(e){case"CIRCLE":i={type:"Circle",coordinates:this.scanCircle()};break;case"MULTICIRCLE":i={type:"MultiCircle",coordinates:this.scanCirlces()};break;case"POINT":{const e=this.scanCoordinates(!1);if(1!==e.length)throw new Error("expect 1 got ".concat(e.length," points"));i={type:"Point",coordinates:e[0]};break}case"MULTIPOINT":i={type:"MultiPoint",coordinates:this.scanCoordinates(!0)};break;case"LINESTRING":{const e=this.scanCoordinates(!1);if(e.length<2)throw new Error("must have at least 2 points, got ".concat(e.length));i={type:"LineString",coordinates:e};break}case"POLYGON":i={type:"Polygon",coordinates:this.scanPolyData(!0)};break;case"MULTIPOLYGON":i={type:"MultiPolygon",coordinates:this.scanMultiPolyData()};break;case"MULTILINESTRING":i={type:"MultiLineString",coordinates:this.scanPolyData(!1)};break;default:throw new Error("unknown geometry ".concat(e))}if(this.i+1<=this.raw.length)throw new Error("expect EOF");return i}}function ae(e){return 1===e.length&&[" ","\n","\t","\r"].includes(e)}function de(e){return[".","-","0","1","2","3","4","5","6","7","8","9"].includes(e)}function se(e){return 1===e.length&&e.match(/[a-zA-Z]/i)}var ue=t(82505),ce=(t(80128),t(31890),t(62953)),pe=t(64505);function fe(e,i){const[t,n,o]=i.coordinates;if("Point"===e.type){return(0,pe.Z)([t,n],e.coordinates,{units:"kilometers"})<=o/1e3}const l=o/1e3,r=l/111.32,a=l/(111.32*Math.cos(n*(Math.PI/180))),d=t-a,s=t+a,u=n-r,c=n+r,[p,f,v,m]=(0,ee.Z)(e);if(v<d||p>s||m<u||f>c)return!1;if(p>=d&&v<=s&&f>=u&&m<=c){if([[p,f],[p,m],[v,f],[v,m]].every((e=>(0,pe.Z)([t,n],e,{units:"kilometers"})<=l)))return!0}let h=Math.round(16+6*Math.sqrt(l));return h=Math.max(16,Math.min(h,64)),(0,ue.Z)(e,(0,ce.Z)([t,n],l,{steps:h,units:"kilometers"}).geometry)}const{GCJ02:ve,WGS84:me,BD09MC:he}=$.default;function ye(e){try{return function(e){return new re(e).scanGeometry()}(e)}catch{return}}function ge(e,i){try{const t=ye(e),n=ye(i);return!(!t||!n)&&function(e,i){if("MultiCircle"===i.type)return i.coordinates.map((e=>({type:"Circle",coordinates:e}))).some((i=>fe(e,i)));return"Circle"===i.type?fe(e,i):(0,ue.Z)(e,i)}(t,n)}catch(t){return!1}}const be=(()=>{function e(e){return!!e&&("and"in e&&Array.isArray(e.and))}function i(e){return!!e&&("or"in e&&Array.isArray(e.or))}function t(t){return t?e(t)?0===t.and.length?null:1===t.and.length?t.and[0]:t:i(t)?0===t.or.length?null:1===t.or.length?t.or[0]:t:t:null}function n(t){return t?e(t)?[t,...t.and.flatMap(n)]:i(t)?[t,...t.or.flatMap(n)]:[t]:[]}function o(t,n){return!!t&&(e(t)?t.and.every((e=>o(e,n))):i(t)?0===t.or.length||t.or.some((e=>o(e,n))):"op"in t&&n(t))}return{isEmpty:function t(n){return!n||("object"!==typeof n||(e(n)?!n.and.length||n.and.every(t):i(n)?!n.or.length||n.or.every(t):!("op"in n)&&!("id"in n)))},flat:n,compact:t,map:function t(n,o){return n?e(n)?{...n,and:n.and.map((e=>t(e,o))).filter(Boolean)}:i(n)?{...n,or:n.or.map((e=>t(e,o))).filter(Boolean)}:"op"in n||"id"in n?o(n):null:null},filter:function t(n,o){if(!n)return null;if(!e(n)&&!i(n))return o(n)?n:null;const l="and"in n?n.and:n.or,r=[];for(const a of l)if(e(a)||i(a)){const e=t(a,o);e&&r.push(e)}else a&&o(a)&&r.push(a);return"and"in n?{...n,and:r}:{...n,or:r}},filterGroup:function t(n,o){if(!n)return null;if(!o(n))return null;if(!e(n)&&!i(n))return n;const l="and"in n?n.and:n.or,r=[];for(const a of l)if(e(a)||i(a)){const e=t(a,o);e&&r.push(e)}else r.push(a);return"and"in n?{...n,and:r}:{...n,or:r}},every:function t(n,o){return!n||(e(n)?n.and.every((e=>t(e,o))):i(n)?n.or.every((e=>t(e,o))):o(n))},and:function(){for(var i=arguments.length,t=new Array(i),n=0;n<i;n++)t[n]=arguments[n];const o=t.filter((e=>!!e));if(0===o.length)return null;let l=o[0];for(let d=1;d<o.length;d++)r=l,a=o[d],l={and:[...e(r)?r.and:[r],...e(a)?a.and:[a]]};var r,a;return l},or:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const o=t.filter((e=>!!e));if(0===o.length)return null;let l=o[0];for(let d=1;d<o.length;d++)r=l,a=o[d],l={or:[...i(r)?r.or:[r],...i(a)?a.or:[a]]};var r,a;return l},append:function(t){for(var n=arguments.length,o=new Array(n>1?n-1:0),l=1;l<n;l++)o[l-1]=arguments[l];const r=o.filter((e=>!!e));return 0===r.length?t:e(t)?{...t,and:[...t.and,...r]}:i(t)?{...t,or:[...t.or,...r]}:{and:[t,...r]}},size:function(t,n){var o;return function t(n){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!n)return 0;if("object"!==typeof n)return 0;if("filter"in n&&ne()(null===n||void 0===n?void 0:n.filter))return 0;if(e(n)||i(n)){const i=o>0&&!l?1:0,r=(e,i)=>e+t(i,o+1,l);return(e(n)?n.and.reduce(r,0):n.or.reduce(r,0))||i}return"id"in n||"op"in n?1:0}(t,0,null!==(o=null===n||void 0===n?void 0:n.ignoreEmptyGroup)&&void 0!==o&&o)},mutate:function t(n,o){if(!n.id||!o.id)return{result:n,found:!1};if(n.id===o.id)return{result:o,found:!0};if(!e(n)&&!i(n))return{result:n,found:!1};const l=n.id,r="and"in n?n.and:n.or;let a=!1;const d=r.map((e=>{if(a)return e;const i=t(e,o);return i.found?(a=!0,i.result):e}));return{result:"and"in n?{id:l,and:d}:{id:l,or:d},found:a}},test:(e,i)=>o(t(e),i),conjunction:function(e){return"or"in e?"or":"and"},flipTo:function(t,n){if(!t)return null;if(e(t)){const{and:e,...i}=t;return"or"===n?{...i,or:e}:t}if(i(t)){const{or:e,...i}=t;return"and"===n?{...i,and:e}:t}return t},find:function(e,i){return n(e).find(i)},depth:function(t){const n=t=>t?e(t)?1+Math.max(...t.and.map(n)):i(t)?1+Math.max(...t.or.map(n)):0:0;return Math.max(n(t),1)},groups:function t(n){return n?e(n)?n.and.reduce(((e,i)=>[...e,...t(i)]),[n]):i(n)?n.or.reduce(((e,i)=>[...e,...t(i)]),[n]):[]:[]},remove:function e(i,t){return i.id===t?null:"and"in i?{...i,and:i.and.map((i=>e(i,t))).filter(Boolean)}:"or"in i?{...i,or:i.or.map((i=>e(i,t))).filter(Boolean)}:i},children:function(t){return e(t)?[...t.and]:i(t)?[...t.or]:[]}}})();var Ie=t(79129);(0,Ie.vU)({is:{id:"filter.op.is",defaultMessage:"is"},isNot:{id:"filter.op.isNot",defaultMessage:"is not"},equals:{id:"filter.op.eq",defaultMessage:"equal to"},notEqual:{id:"filter.op.neq",defaultMessage:"not equal to"},startsWith:{id:"filter.op.startsWith",defaultMessage:"begins with"},endsWith:{id:"filter.op.endsWith",defaultMessage:"ends with"},lessThan:{id:"filter.op.lt",defaultMessage:"less than"},lessThanOrEqual:{id:"filter.op.lte",defaultMessage:"less than or equal to"},greaterThan:{id:"filter.op.gt",defaultMessage:"greater than"},greaterThanOrEqual:{id:"filter.op.gte",defaultMessage:"greater or equal to"},contains:{id:"filter.op.contains",defaultMessage:"contains"},containsAny:{id:"filter.op.containsAny",defaultMessage:"has any of"},containsAll:{id:"filter.op.containsAll",defaultMessage:"has all of"},notContains:{id:"filter.op.notContiains",defaultMessage:"has none of"},empty:{id:"filter.op.empty",defaultMessage:"is empty"},isNull:{id:"filter.op.isNull",defaultMessage:"is empty"},isNotNull:{id:"filter.op.isNotNull",defaultMessage:"is not empty"},inArea:{id:"filter.op.inArea",defaultMessage:"is in area"},isAfter:{id:"filter.op.after",defaultMessage:"is after"},isBefore:{id:"filter.op.before",defaultMessage:"is before"}});var Ce=t(46131),De=t(7070),Fe=t.n(De),ke=t(18765),we=t.n(ke),Oe=t(55349),Me=t.n(Oe),Te=t(20780),Ne=t(8942),Pe=t.n(Ne),Se=t(74720),Ee=t.n(Se),Le=(t(34362),t(17646)),Be=t.n(Le),Ae=t(56356),xe=t.n(Ae),Re=t(468),Ge=t.n(Re),je=t(82813),qe=t.n(je),ze=t(42015),We=t(36441),Ve=t(40978),_e=t(13424),Ue=t(29630),Ye=t(93033);const He="optimized",Ze=("".concat("https://icon-cdn.maptable.com","/assets/boundary_data"),85);let Ke,Je;async function Qe(e){var i;let{locale:t,mapInfo:n,tableNode:o,geojson:l,allIndexOptions:r,dashboardData:a}=e;if("optimized"===He&&"region"===(null===n||void 0===n||null===(i=n.regionConfig)||void 0===i?void 0:i.dimension))return await(0,Ye.l)({locale:t,mapInfo:n,tableNode:o,geojson:l,allIndexOptions:r,dashboardData:a});const s=[],u=[],c=d()(l),{regionDimensionFieldID:p,regionIndexStatsFieldID:f,specifyByFieldID:v,regionConfig:m}=n,{dimension:h,aggregateBy:y,regionId:g,indexStatsMethod:b}=m;if(!p||!f||!c||!o)return null===c||void 0===c||c.features.map((e=>(e.properties=Ge()(e.properties,["aggregationValue","aggregationFormatValue"]),e))),{computingGeoJSON:c};(Ke&&!Pe()(p,Ke)||Je&&!Pe()(f,Je))&&(null===c||void 0===c||c.features.map((e=>(e.properties=Ge()(e.properties,["aggregationValue","aggregationFormatValue"]),e)))),Ke=p,Je=f;const I=g||"china";if("region"===h){const e=qe()(r),i=new Te.Z(e,ze.Hk),n=new Te.Z(e,ze.Yk),l=o.rows||[],d=o.columns||[],m=JSON.stringify((null===d||void 0===d?void 0:d.find((e=>e.id===f)))||{}),h=d.find((e=>e.id===p)),g=d.find((e=>e.id===v)),O=new Map,M=new Map(c.features.map((e=>{var i;return[null===(i=e.properties)||void 0===i?void 0:i.id,e]}))),T=new Map(e.map((e=>[e.id,e.parentId]))),N=!!g;let P=[],S=b;a?(Be()(a,((e,i)=>{Be()(e,((e,t)=>{P.push({regionName:xe()(i),specifyByName:N?t:null,value:e.value,dashboardValue:"mean"===S?e:void 0,rowId:i})}))})),"count"!==b&&"nonEmptyCount"!==b||(S="sum")):P=l.reduce(((e,i,t)=>{const n=(0,_e.hb)(i,h);if(!n)return e;const o=i.cells[f],l=i.id;return e.push({regionName:n,specifyByName:(0,_e.hb)(i,g),value:o,rowId:l}),e}),[]),u.push(...P);const E=await(0,Ue.zK)(I),L=new Set(P.map((e=>"".concat(e.regionName,"-").concat(e.specifyByName||"","-").concat(y||"")))),B=await Promise.all([...L].map((e=>(0,Ue.TK)(e,E)))),A=new Map([...L].map(((e,i)=>[e,B[i]]))),x={};for(const t of P){var C;if(t.regionName&&t.regionName.length>Ze){s.push(t);continue}const e="".concat(t.regionName,"-").concat(t.specifyByName||"","-").concat(y||"");let o=A.get(e);if(void 0===o){var D;const l=await(0,_e.Lu)(t.regionName,n,i);if(null===l||void 0===l||!l.length){x[e]=null;continue}o=await(0,_e.XN)({directFuzzyMatchResult:l,specifyMatchValue:t.specifyByName,strictFUse:n,fuzzyFUse:i,aggregateBy:y}),((null===(D=o)||void 0===D?void 0:D.score)||0)>ze.a&&(o=null),A.set(e,o||null),x[e]=o||null}if(Me()(o)){s.push(t);continue}const l=null===(C=o.item)||void 0===C?void 0:C.id;if(!l){s.push(t);continue}const r=t.value,a=t.rowId;O.has(l)||O.set(l,[]),O.get(l).push({value:r,rowId:a,dashboardValue:t.dashboardValue});let d=l;for(let i=0;i<2;i++){const e=T.get(d);if(!e)break;O.has(e)||O.set(e,[]),O.get(e).push({value:r,rowId:a,dashboardValue:t.dashboardValue}),d=e}}await(0,Ue.Iv)(x,E);for(const[o,r]of O){var F,k,w;const e=M.get(o);if(!e)continue;if(o===We.q)continue;const i="zh-CN"===t?(null===(F=e.properties)||void 0===F?void 0:F.display_name)||(null===(k=e.properties)||void 0===k?void 0:k.name_zh):null===(w=e.properties)||void 0===w?void 0:w.name_en;e.type="Feature";let n=r.map((e=>e.value));if("mean"===S&&r.length>1){const{sum:e,count:i,isDashboardValue:t}=r.reduce(((e,i)=>(i.dashboardValue&&(e.sum+=i.dashboardValue.sum||0,e.count+=i.dashboardValue.count||0,e.isDashboardValue=!0),e)),{sum:0,count:0,isDashboardValue:!1});t&&(n=[i>0?e/i:0])}const l=Xe({aggregationValue:n,indexStatsMethod:b,columns:d,regionDimensionFieldID:p,regionIndexStatsFieldID:f,name:i});e.properties={...e.properties||{},name:i,tooltip:l,aggregationValue:n,aggregationMethod:S,rowIds:r.map((e=>e.rowId)),indexStatsColumn:m}}}else if("coordinate"===h){const e=o.rows,i=o.columns,n=new Map,l=JSON.stringify((null===i||void 0===i?void 0:i.find((e=>e.id===f)))||{});for(const o of e){const e=o.cells[p];if(e)try{const r=(0,Ve.HF)(e);if("Point"!==r.type)continue;let a=!1;u.push({regionName:o.cells[p],specifyByName:null,value:0,rowId:o.id});for(const e of c.features){const d="zh-CN"===t?Ee()(e,"properties.display_name")||Ee()(e,"properties.name_zh"):Ee()(e,"properties.name_en");if((0,ie.Z)(r.coordinates,e)){var O,M,T;const t=null===(O=e.properties)||void 0===O?void 0:O.id;n.has(t)||n.set(t,[]),n.get(t).push({value:o.cells[f],rowId:o.id});const r=(null===(M=n.get(t))||void 0===M?void 0:M.map((e=>e.value)))||[],s=Xe({aggregationValue:r,indexStatsMethod:b,columns:i,regionDimensionFieldID:p,regionIndexStatsFieldID:f,name:d});e.type="Feature",e.properties={...e.properties||{},tooltip:s,name:d,aggregationValue:r,rowIds:(null===(T=n.get(t))||void 0===T?void 0:T.map((e=>e.rowId)))||[],indexStatsColumn:l},a=!0;break}}a||s.push({rowId:o.id,regionName:Ee()(o.cells,"".concat(p,"-fullAddress"),o.cells[p]),value:0,specifyByName:null})}catch{continue}}}return{computingGeoJSON:c,notMatchedItems:s,totalItems:u}}function Xe(e){var i,t;let{aggregationValue:n,indexStatsMethod:o,columns:l,regionDimensionFieldID:r,regionIndexStatsFieldID:a,name:d}=e;const s=(0,ze.Bb)(n,o),u=null===l||void 0===l||null===(i=l.find((e=>e.id===r)))||void 0===i?void 0:i.name,c=null===l||void 0===l||null===(t=l.find((e=>e.id===a)))||void 0===t?void 0:t.name,p=s?(0,Ce.IG)(s):null;return"".concat(u,": ").concat(d,"\n").concat(null!==c&&void 0!==c?c:"Count",": ").concat(p)}t(57435);var $e=t(56439),ei=t.n($e),ii=t(99540),ti=t.n(ii),ni=t(62618),oi=t.n(ni),li=t(57889),ri=t.n(li),ai=t(42552),di=t(31343);t(84527);const si=1e6,ui={is:{key:"is"},isNot:{key:"isNot"},equals:{key:"equals",mark:"="},notEqual:{key:"notEqual",mark:"\u2260"},startsWith:{key:"startsWith"},endsWith:{key:"endsWith"},lessThan:{key:"lessThan",mark:"<"},lessThanOrEqual:{key:"lessThanOrEqual",mark:"\u2264"},greaterThan:{key:"greaterThan",mark:">"},greaterThanOrEqual:{key:"greaterThanOrEqual",mark:"\u2265"},contains:{key:"contains"},containsAny:{key:"contains"},containsAll:{key:"containsAll"},notContains:{key:"notContains"},empty:{key:"empty"},isNull:{key:"isNull"},isNotNull:{key:"isNotNull"},inArea:{key:"inArea"},inRange:{key:"inRange"},notInRange:{key:"notInRange"},isAfter:{key:"isAfter"},isBefore:{key:"isBefore"}};let ci=function(e){return e.is="is",e.isNot="isNot",e.equals="equals",e.notEqual="notEqual",e.startsWith="startsWith",e.endsWith="endsWith",e.lessThan="lessThan",e.lessThanOrEqual="lessThanOrEqual",e.greaterThan="greaterThan",e.greaterThanOrEqual="greaterThanOrEqual",e.contains="contains",e.containsAll="containsAll",e.notContains="notContains",e.empty="empty",e.inRange="inRange",e.inArea="inArea",e.isNull="isNull",e.isNotNull="isNotNull",e.notInRange="notInRange",e.isBefore="isBefore",e.isAfter="isAfter",e}({});Object.keys(ui);var pi=t(91671),fi=t(75538),vi=t.n(fi),mi=(t(23903),t(46881),t(92626)),hi=t.n(mi),yi=t(58674),gi=t.n(yi);const bi=["multiLineText","coordinate","number","singleChoice","multiChoice","datetime","attachment","boolean","createTime","updateTime","formula","creator","updater","member","hyperlink","related","lookup"];gi()(bi,"multiLineText","coordinate","number","singleChoice","multiChoice","datetime","attachment","boolean","hyperlink"),gi()(bi,"related","lookup");t(65235);const Ii={"year/month/day":"YYYY/MM/DD","month/day/year":"MM/DD/YYYY",detail:"YYYY-M-DD"},Ci={"12-hour-clock":"h:mm","24-hour-clock":"HH:mm",hidden:""};(0,Ie.vU)({days:{id:"UA5qaX",defaultMessage:"{days, plural, one {# day} other {# days}}"}});(0,t(64201).Sn)();var Di=t(7336),Fi=t.n(Di),ki=t(83177),wi=t.n(ki);function Oi(e,i){return i?e.tz(i):e}r().extend(Fi()),r().extend(wi());const Mi=(()=>{const e={};return function(i){if(i in e)return e[i];const t="Invalid Date"!==new Date(i).toString();return e[i]=t,t}})(),Ti=(()=>{const e=Object.keys(Ii)[0],i=Object.keys(Ii)[2],t={};return function(n,o,l){var a,d;if(!Mi(n))return n?String(n):"";const s=null!==(a=null===o||void 0===o?void 0:o.dateFormat)&&void 0!==a?a:e,u=null!==(d=null===o||void 0===o?void 0:o.timeFormat)&&void 0!==d?d:i,c="12-hour-clock"===u?" A":"",p=null!==o&&void 0!==o&&o.showTimezone?" ([GMT] Z)":"";let f="".concat(Ci[u]||"").concat(c).concat(p);const v=Ii[s];v&&(f=v+" "+f);const m="".concat(n,"/").concat(f,"/").concat(l||"");if(m in t)return xe()(t[m]);const h=r()(n);return t[m]=Oi(h,l).format(f),xe()(t[m])}})();function Ni(e){let{type:i,typeOptions:t}=e;return"formula"===i&&"multiLineText"===(null===t||void 0===t?void 0:t.expectedType)}function Pi(e){let{type:i,typeOptions:t}=e;return"lookup"===i&&!(null===t||void 0===t||!t.lookupResultType)&&"original"!==t.lookupResultType&&"distinct"!==t.lookupResultType}function Si(e){let{type:i,typeOptions:t}=e;return"lookup"===i&&("original"===(null===t||void 0===t?void 0:t.lookupResultType)||"distinct"===(null===t||void 0===t?void 0:t.lookupResultType))}function Ei(e){return!!e&&("number"===e.type||function(e){let{type:i,typeOptions:t}=e;return"formula"===i&&"number"===(null===t||void 0===t?void 0:t.expectedType)}(e)||Pi(e))}function Li(e){return!!e&&("multiLineText"===e.type||function(e){let{type:i,typeOptions:t}=e;return"lookup"===i&&("original"===(null===t||void 0===t?void 0:t.lookupResultType)||"distinct"===(null===t||void 0===t?void 0:t.lookupResultType))&&"coordinate"!==t.lookupColumnType&&"attachment"!==t.lookupColumnType&&"singleChoice"!==t.lookupColumnType&&"number"!==t.lookupColumnType}(e)||Ni(e))}function Bi(e){return!!e&&(Ei(e)||function(e){var i;return Si(e)&&("number"===e.typeOptions.lookupColumnType||"formula"===e.typeOptions.lookupColumnType&&"number"===(null===(i=e.typeOptions.lookupColumnTypeOptions)||void 0===i?void 0:i.expectedType))}(e))}function Ai(e){var i;return!!e&&(function(e){return!!e&&"singleChoice"===e.type}(e)||"singleChoice"===(null===(i=e.typeOptions)||void 0===i?void 0:i.lookupColumnType))}function xi(e){let{type:i,typeOptions:t}=e;return"datetime"===i||"updateTime"===i||"createTime"===i||"formula"===i&&"datetime"===(null===t||void 0===t?void 0:t.expectedType)||"lookup"===i&&"datetime"===(null===t||void 0===t?void 0:t.lookupColumnType)}function Ri(e){return"related"===e.type}function Gi(e){let{type:i,typeOptions:t}=e;return"creator"===i||"updater"===i||function(e){var i,t,n;return"lookup"===(null===e||void 0===e?void 0:e.type)&&("member"===(null===e||void 0===e||null===(i=e.typeOptions)||void 0===i?void 0:i.lookupColumnType)||"creator"===(null===e||void 0===e||null===(t=e.typeOptions)||void 0===t?void 0:t.lookupColumnType)||"updater"===(null===e||void 0===e||null===(n=e.typeOptions)||void 0===n?void 0:n.lookupColumnType))}({type:i,typeOptions:t})}function ji(e){return!!e&&(Gi(e)||"member"===e.type)}function qi(e,i,t,n){var o;let l=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const r=null===i||void 0===i?void 0:i.type,a=null===i||void 0===i?void 0:i.typeOptions;if("singleChoice"===r||"multiChoice"===r||"lookup"===r&&("singleChoice"===(null===a||void 0===a?void 0:a.lookupColumnType)||"multiChoice"===(null===a||void 0===a?void 0:a.lookupColumnType)))return vi()(Fe()(ei()(e,","),(e=>{var i,t,n;return null!==(i=null===(t=((null===a||void 0===a?void 0:a.choices)||(null===a||void 0===a||null===(n=a.lookupColumnTypeOptions)||void 0===n?void 0:n.choices)||[]).find((i=>i.id===e)))||void 0===t?void 0:t.name)&&void 0!==i?i:""})));if("attachment"===r)return vi()(Fe()(e,(e=>e.url)));if("multiLineText"===r&&l){const i=new(hi())([[e]]).encode(),t=i.slice(1,-1);return t.match(/[\n\t"]/gm)?i:t}if("boolean"===r)return e?"True":"False";var d,s,u;if("number"===r)return p()(e)?(0,pi.P)(e,null!==(d=null===a||void 0===a?void 0:a.precision)&&void 0!==d?d:0,null===a||void 0===a?void 0:a.format):e;if("formula"===r){var c;if("number"===(null===a||void 0===a?void 0:a.expectedType)&&null!==e)return(0,pi.P)(ti()(e),null!==(c=null===a||void 0===a?void 0:a.numberPrecision)&&void 0!==c?c:0,null===a||void 0===a?void 0:a.numberFormat);if("multiLineText"===(null===a||void 0===a?void 0:a.expectedType)&&l){const i=new(hi())([[e]]).encode(),t=i.slice(1,-1);return t.match(/[\n\t"]/gm)?i:t}if(null!==e&&Array.isArray(e))return e.map((e=>e.text)).join(",")}if("member"===r)return vi()(Fe()(e,(e=>{var i,n;return null!==(i=null===t||void 0===t||null===(n=t.find((i=>i.id===e)))||void 0===n?void 0:n.name)&&void 0!==i?i:""})));if("updater"===r||"creator"===r)return null!==(s=null!==(u=null===e||void 0===e?void 0:e.name)&&void 0!==u?u:vi()(Fe()(e,(e=>{var i,n;return null!==(i=null===t||void 0===t||null===(n=t.find((i=>i.id===e)))||void 0===n?void 0:n.name)&&void 0!==i?i:""}))))&&void 0!==s?s:"";if("related"===r)return vi()(Fe()(e,(e=>{var i;return null!==(i=null===e||void 0===e?void 0:e.displayName)&&void 0!==i?i:""})));if("lookup"===r)switch(null===a||void 0===a?void 0:a.lookupColumnType){case"number":return vi()(Fe()(e,(e=>{var i;return p()(e)?(0,pi.P)(e,null!==(i=null===a||void 0===a?void 0:a.precision)&&void 0!==i?i:0,null===a||void 0===a?void 0:a.format):e})));case"updater":case"creator":case"member":return vi()(Fe()(e,(e=>{var i,n;return null!==(i=null===t||void 0===t||null===(n=t.find((i=>i.id===e)))||void 0===n?void 0:n.name)&&void 0!==i?i:""})));case"singleChoice":case"multiChoice":return vi()(Fe()(ei()(e,","),(e=>{var i,t;return null!==(i=null===a||void 0===a||null===(t=a.lookupColumnTypeOptions)||void 0===t||null===(t=t.choices)||void 0===t||null===(t=t.find((i=>i.id===e)))||void 0===t?void 0:t.name)&&void 0!==i?i:""})));case"datetime":case"createTime":case"updateTime":return vi()(Fe()(e,(e=>Me()(e)?"":Ti(e,null===a||void 0===a?void 0:a.lookupColumnTypeOptions,n))));case"related":return vi()(Fe()(e,(e=>{var i;return null!==(i=null===e||void 0===e?void 0:e.displayName)&&void 0!==i?i:""})));case"formula":switch(null===a||void 0===a||null===(o=a.lookupColumnTypeOptions)||void 0===o?void 0:o.expectedType){case"datetime":return vi()(Fe()(e,(e=>{var i,t,o;return Me()(e)?"":Ti(e,{dateFormat:null===a||void 0===a||null===(i=a.lookupColumnTypeOptions)||void 0===i?void 0:i.datetimeDateFormat,timeFormat:null===a||void 0===a||null===(t=a.lookupColumnTypeOptions)||void 0===t?void 0:t.datetimeTimeFormat,showTimezone:null===a||void 0===a||null===(o=a.lookupColumnTypeOptions)||void 0===o?void 0:o.showTimezone},n)})));case"number":return vi()(Fe()(e,(e=>{var i;return p()(e)?(0,pi.P)(e,null!==(i=null===a||void 0===a?void 0:a.precision)&&void 0!==i?i:0,null===a||void 0===a?void 0:a.format):e})))}return vi()(e);default:return Array.isArray(e)?vi()(e):e}return null!==e&&void 0!==e?e:""}var zi=t(14083);let Wi=function(e){return e.ProjectPage="readonly",e.ProjectEdit="admin",e.ProjectDuplicate="admin",e.Collaborator="readonly",e.CollaboratorEdit="admin",e.CollaboratorInvite="admin",e.CollaboratorRemove="admin",e.CollaboratorQuit="readonly",e.ProjectDelete="admin",e.ProjectTransfer="owner",e.ProjectRecycleBinPage="readonly",e.ProjectSetting="admin",e.RecycleBinRecover="admin",e.RecycleBinDelete="admin",e.TableSiderPlusButton="editable",e.NewTable="editable",e.NewFolder="editable",e.ImportData="editable",e.TableFolderRename="editable",e.TableFolderDelete="editable",e.MapSiderPlusButton="editable",e.NewMapLayer="editable",e.NewMapFolder="editable",e.MapSetting="editable",e.MapFolderRename="editable",e.MapFolderDelete="editable",e.MapLayerRename="editable",e.MapLayerSetting="editable",e.MapLayerViewTable="readonly",e.MapLayerDelete="admin",e.MapShare="admin",e.ProjectShare="admin",e.SiderHelp="readonly",e.TreeItemDraggable="editable",e.MapSearch="readonly",e.DashboardEdit="admin",e.DashboardShare="admin",e.TableViewCreate="editable",e.AnnotationEditable="editable",e.CreateH3Tile="admin",e}({}),Vi=function(e){return e.TablePage="readonly",e.MemberInvite="admin",e.ProjectRecycleBinActions="admin",e.MenuItemRename="editable",e.MenuItemMember="readonly",e.MenuItemDuplicate="admin",e.MenuItemDelete="admin",e.MenuItemSync="admin",e.GridHideColumn="editable",e.GridFilter="editable",e.GridSorting="editable",e.GridGrouping="editable",e.GridRowHeight="editable",e.GridSearch="readonly",e.GridExport="editable",e.GridSnapshot="editable",e.LayerControl="readonly",e.MapFilter="readonly",e.MapNearBy="readonly",e.MapExport="editable",e.ViewShare="editable",e.FormFieldEdit="editable",e.RowShare="editable",e.InfoWindowConfig="admin",e.DetailPanelConfig="admin",e.DetailPanelShare="editable",e.DataEdit="editable",e.MapLayerSetting="editable",e.LockView="admin",e.ReassignView="admin",e.LockField="admin",e.LockTable="admin",e}({});Wi.NewMapLayer,Wi.NewMapFolder,Wi.NewMapLayer,Wi.ImportData,Wi.ImportData,Wi.ImportData,Wi.ImportData,Wi.ImportData,Wi.NewMapLayer,Wi.NewMapFolder,Wi.NewMapLayer,Wi.MapFolderRename,Wi.MapFolderDelete,[{action:"fitBounds",key:"fitBounds"},{action:"showThisLayerOnly",key:"showThisLayerOnly"},{isDivider:!0},{action:"openLayerSetting",key:"openLayerSetting"},{key:"divider",isDivider:!0},{action:"editItem",key:"editItem",permission:Wi.MapLayerRename},{action:"replicate",key:"duplicate",permission:Wi.NewMapLayer},null,{isDivider:!0},{action:"conv2vector",key:"conv2vector",permission:Wi.NewMapLayer,tooltip:(0,zi.Em)({id:"8z1uai",defaultMessage:"Vector tiles significantly improve map layer loading performance when processing large-scale datasets. <a>Learn more about Vector tiles.</a>"}),link:"conv2vector",plan:"ent"},{action:"vtRecreate",key:"vtRecreate",permission:Wi.NewMapLayer,plan:"ent"},{action:"publishLayer",key:"publishLayer",permission:Wi.MapShare},{action:"deleteItem",key:"delete",type:"danger",permission:Wi.MapLayerDelete}].filter(Boolean),Wi.NewTable,Wi.NewFolder,Wi.ImportData,Wi.ImportData,Wi.ImportData,Wi.ImportData,Wi.ImportData,Wi.ImportData,(0,zi.Em)({id:"N455eL",defaultMessage:"Subscribe to publicly shared data tables from other collaborators to keep synced tables aligned with the source data. <a>Learn more about Maptable sync table.</a>"}),Wi.ImportData,Wi.TableFolderRename,Wi.NewTable,Wi.TableFolderDelete,Vi.MenuItemRename,Vi.MenuItemMember,Vi.MenuItemDuplicate,Vi.MenuItemDelete,Vi.MenuItemRename,Vi.MenuItemMember,Vi.MenuItemSync,Vi.MenuItemSync,Vi.MenuItemDelete,Vi.MenuItemRename,Vi.MenuItemMember,Vi.MenuItemDelete,Wi.ProjectEdit,Wi.Collaborator,Vi.DataEdit,Vi.DataEdit;function _i(e){let{date:i,typeOptions:t,isGpuDatetime:n}=e;if(null!==t&&void 0!==t&&t.dateFormat&&null!==t&&void 0!==t&&t.timeFormat){const e=i&&n&&"number"===typeof i?i*si:i;return r()(e).valueOf()}return i&&Mi(i)?r()(i).valueOf():ti()(i)}const Ui=e=>{if(!e)return"";let i=[],t=[];try{"string"===typeof e?i=JSON.parse(e):"object"===typeof e&&(i=e),t=i.map((e=>e.displayName))}catch(n){return""}return String(oi()(t)).toLowerCase()},Yi=(e,i,t)=>{var n;if("datetime"===(null===i||void 0===i?void 0:i.lookupColumnType)||"formula"===(null===i||void 0===i?void 0:i.lookupColumnType)&&"datetime"===(null===i||void 0===i||null===(n=i.lookupColumnTypeOptions)||void 0===n?void 0:n.expectedType)){return null===(Array.isArray(e)?1===e.length?e[0]:null:e)?NaN:_i({date:e,typeOptions:null===i||void 0===i?void 0:i.lookupColumnTypeOptions,isGpuDatetime:t})}return"related"===(null===i||void 0===i?void 0:i.lookupColumnType)?Ui(e):String(Hi(e)).toLowerCase()};function Hi(e){return Array.isArray(e)?oi()(e).join(","):e}const Zi=/^P(-)?(\d+Y)?(\d+Q)?(\d+M)?(\d+W)?(\d+D)?(=)?$/;function Ki(e){return Array.isArray(e)&&e.length>0&&"key"in e[0]}function Ji(e,i,t,n){if(null==e)switch(t){case ci.isNot:case ci.notEqual:case ci.notContains:case ci.isNull:return!0;default:return!1}switch(t){case ci.equals:return e===n||""===n;case ci.notEqual:return e!==n;case ci.is:if(i.datetime&&(o=n,Array.isArray(o)&&o.length>0&&"number"===typeof o[0])){const i=+e,[t,o]=n;return t<=i&&i<=o}return e===n;case ci.isNot:return e!==n;case ci.startsWith:return 0===String(e).indexOf(n);case ci.endsWith:return String(e).lastIndexOf(String(n))===String(e).length-String(n).length;case ci.isBefore:case ci.lessThan:return ti()(e)<ti()(n);case ci.lessThanOrEqual:return ti()(e)<=ti()(n);case ci.isAfter:case ci.greaterThan:return ti()(e)>ti()(n);case ci.greaterThanOrEqual:return ti()(e)>=ti()(n);case ci.contains:return i.choice||i.user||i.lookupUser||i.lookupChoice?String(n).split(",").some((i=>String(e).split(",").includes(i))):String(e).indexOf(String(n))>=0;case ci.containsAll:return String(e).indexOf(String(n))>=0;case ci.notContains:return i.choice||i.lookupChoice||i.user?!String(n).split(",").some((i=>String(e).split(",").includes(i))):-1===String(e).indexOf(String(n));case ci.isNull:return i.number?isNaN(ti()(e))||"undefined"===typeof e:!e;case ci.isNotNull:return i.number?!isNaN(ti()(e))&&"undefined"!==typeof e:!!e;case ci.inArea:return ge(String(e),String(n));case ci.inRange:{if(!Ki(n))return!!e;const t=i.choice||i.lookupChoice?et(e):e;return n.every((e=>ti()(t)>=e.values[0]&&ti()(t)<=e.values[1]))}case ci.notInRange:{if(!Ki(n))return!!e;const t=i.choice||i.lookupChoice?et(e):e;return n.every((e=>ti()(t)<e.values[0]||ti()(t)>e.values[1]))}default:return!0}var o}function Qi(e,i,t){const n=e.value;if(void 0===n)return n;const o=null===t||void 0===t?void 0:t.now,l=null===t||void 0===t?void 0:t.useGPU,a=null===t||void 0===t?void 0:t.timezone,d=e.field.typeOptions,s=null===t||void 0===t?void 0:t.mondayFirst,u=e.op.key;if(i.datetime&&u===ci.is){const e=function(e){let{s:i,now:t=r()(),mondayFirst:n=!1,timezone:o}=e;if("string"!==typeof i)return null;if("P"!==i[0])return null;if(i.length<3)return null;const l=i.match(Zi);if(!l)return null;const a="-"===l[1]?-1:1,d="="===l[l.length-1],[s,u,c,p,f]=l.slice(2).map((e=>e?parseInt(e.slice(0,-1)):null)),v=Oi(t,o),m=v.startOf("day");if(null!==s){const e=v.add(a*s,"year");return d?[e,m]:[e.startOf("year"),e.endOf("year")]}if(null!==u){const e=v.add(a*u,"quarter");return d?[e,m]:[e.startOf("quarter"),e.endOf("quarter")]}if(null!==c){const e=v.add(a*c,"month");return d?[e,m]:[e.startOf("month"),e.endOf("month")]}if(null!==p){const e=v.add(a*p,"week");return n?d?[e,m]:[e.startOf("week").add(1,"day"),e.endOf("week").add(1,"day")]:d?[e,m]:[e.startOf("week"),d?v:e.endOf("week")]}return null!==f?a>0?d?[v.startOf("day"),v.add(f,"day").endOf("day")]:[v.add(1,"day").startOf("day"),v.add(f,"day").endOf("day")]:d?[v.subtract(f,"day").startOf("day"),v.startOf("day")]:[v.subtract(f,"day").startOf("day"),v.subtract(1,"day").endOf("day")]:null}({s:n,now:o,mondayFirst:s,timezone:a});if(e)return e.map((e=>_i({date:e.toDate(),typeOptions:d,isGpuDatetime:l})))}if(u===ci.inRange||u===ci.notInRange){if(!n)return;return(c=String(n))?ri()(c.split(","),3).reduce(((e,i)=>{const t={key:i[0],values:[ti()(i[1]),ti()(i[2])]};return e.push(t),e}),[]):[]}var c;return i.number?+n:i.datetime?_i({date:n,typeOptions:d}):i.related?Ui(n):i.lookup?Yi(n,d):String(Hi(n)).toLowerCase()}class Xi{constructor(e,i){this.filter=null!==e&&void 0!==e?e:void 0,this.useGPU=(null===i||void 0===i?void 0:i.isGpuDatetime)||!1,this.mondayFirst=(null===i||void 0===i?void 0:i.mondayFirst)||!1,this.timezone=null===i||void 0===i?void 0:i.timezone,this.now=null===i||void 0===i?void 0:i.now,this.isLngLat=null===i||void 0===i?void 0:i.isLngLat,null!==i&&void 0!==i&&i.skipCache||(this.weakmap=new WeakMap)}format(e,i){const{is:t,formatCell:n,formattedValue:o}=this.cached(e);return{is:t,formattedCell:n(i),formattedValue:o}}cached(e){var i,t;if(this.weakmap){const i=this.weakmap.get(e);if(i)return i}const n=e.op.key,o=e.field,l="value"===e.comparing,r=o.typeOptions,a="lookup"===o.type;const d={user:Gi(o),number:Ei(o),datetime:xi(o),choice:(s=o,!!s&&("singleChoice"===s.type||"multiChoice"===s.type)),related:Ri(o),lookup:a,lookupUser:a&&["member","creator","updater"].includes(null!==(i=null===r||void 0===r?void 0:r.lookupColumnType)&&void 0!==i?i:""),lookupChoice:a&&["multiChoice","singleChoice"].includes(null!==(t=null===r||void 0===r?void 0:r.lookupColumnType)&&void 0!==t?t:"")};var s;const u=Qi(e,d,{useGPU:this.useGPU,now:this.now,timezone:this.timezone,mondayFirst:this.mondayFirst}),c=n===ci.equals&&"boolean"===o.type,p={is:d,formattedValue:u,formatCell:e=>{if(null==e)return c?"false":e;const i=d.user?String(null===e||void 0===e?void 0:e.id):d.number?+e:d.datetime?_i({date:e,typeOptions:r,isGpuDatetime:this.useGPU}):d.related?Ui(e):d.lookup?Yi(e,r,this.useGPU):String(Hi(e)).toLowerCase();if(l&&(d.choice||d.lookupChoice)){var t;const i=(null===r||void 0===r?void 0:r.choices)||(null===r||void 0===r||null===(t=r.lookupColumnTypeOptions)||void 0===t?void 0:t.choices)||[];return String(ei()(e).map((e=>{var t;return null===(t=i.find((i=>i.id===e)))||void 0===t?void 0:t.name}))).toLowerCase()}return i}};return this.weakmap&&this.weakmap.set(e,p),p}test(e,i,t){const n=i||this.filter;return!n||be.test(n,(i=>{if(!i.field||!i.op)return!0;let n=e[i.field.id];if(this.isLngLat&&t){const o=e[t];o&&(n="POINT(".concat(n," ").concat(o,")"),Object.assign(i.field,{type:"coordinate"}))}const{is:o,formattedValue:l,formattedCell:r}=this.format(i,n);return Ji(r,o,i.op.key,l)}))}}(0,ai.kP)(di.Q,12);function $i(e,i){if(!i)return;const t=e[i.id];if(!t)return 0;const n=_i({date:t,typeOptions:i.typeOptions});return isNaN(n)?0:n/si}function et(e){let i=0;for(let t=0;t<e.length;t++){i=(i<<5)-i+e.charCodeAt(t),i|=0}return Math.abs(i)}const it=["pointLinePolygon","heatmap","odLine","cluster","icon"];function tt(e){return"Circle"===e.type?{type:"Point",coordinates:[e.coordinates[0],e.coordinates[1]]}:"MultiCircle"===e.type?{type:"MultiPoint",coordinates:e.coordinates.map((e=>e.slice(0,2)))}:e}var nt=t(81659),ot=t.n(nt),lt=t(82959),rt=t.n(lt);function at(e){let{columns:i,cells:t,labelFieldIDs:n=[],items:o,timezone:l,members:r}=e;const a=[],d=[];return null===n||void 0===n||n.forEach(((e,n)=>{var s,u,c,f,v,m,h,y;const g=i instanceof Map?i.get(e):i.find((i=>i.id===e)),b=null===o||void 0===o||null===(s=o[n])||void 0===s?void 0:s.hiddenLabel,I=null===o||void 0===o||null===(u=o[n])||void 0===u?void 0:u.hiddenTooltip;if(!g)return;const C=ot()(pi.P,"number"===(null===g||void 0===g?void 0:g.type)||"lookup"===(null===g||void 0===g?void 0:g.type)?null===g||void 0===g||null===(c=g.typeOptions)||void 0===c?void 0:c.precision:null===g||void 0===g||null===(f=g.typeOptions)||void 0===f?void 0:f.numberPrecision,"number"===(null===g||void 0===g?void 0:g.type)||"lookup"===(null===g||void 0===g?void 0:g.type)?null===g||void 0===g||null===(v=g.typeOptions)||void 0===v?void 0:v.format:null===g||void 0===g||null===(m=g.typeOptions)||void 0===m?void 0:m.numberFormat,"currency"===(null===g||void 0===g||null===(h=g.typeOptions)||void 0===h?void 0:h.format)?null===g||void 0===g||null===(y=g.typeOptions)||void 0===y?void 0:y.numberPrefix:void 0);let D=null===t||void 0===t?void 0:t[g.id];const F=g.name;switch(g.type){case"singleChoice":case"multiChoice":D=qi(D,g);break;case"datetime":case"createTime":case"updateTime":D=null==D?"":Ti(D,g.typeOptions,l);break;case"lookup":Pi(g)||(D=qi(D,g,r,l));break;case"member":case"creator":case"updater":D=qi(D,g,r)}var k,w;(D=Ei(g)&&p()(D)?C(ti()(D)):D,I)||d.push("".concat(F,": ").concat(null!==(k=D)&&void 0!==k?k:""));b||a.push(null!==(w=D)&&void 0!==w?w:"")})),{label:rt()(a).length>0?a.join("\n"):"",tooltip:rt()(d).length>0?d.join("\n"):""}}const dt=globalThis;function st(e,i){return i&&Si(i)&&Array.isArray(e)&&e.length?e[0]:e}function ut(e){if(!Array.isArray(e))return"";const i=(0,o.rS)(e[0]);return Array.isArray(i)?"POINT(".concat(i[1],"  ").concat(i[0],")"):""}function ct(e,i,t,n,o){if(!e||!i||!t||!o)return;let l=Number.MAX_SAFE_INTEGER,r=0,a=[];a=Fe()(we()(null===o||void 0===o?void 0:o.rows,(t=>!Me()(t.cells[i])&&!Me()(t.cells[e]))),(i=>{const t=parseFloat(i.cells[e]);return l=t<l?t:l,r=t>r?t:r,t}));const d="quantize"===n?[l,r]:a;return"quantize"===n?(0,f.Z)().domain(d).range(t):(0,v.Z)().domain(d).range(t)}dt.onmessage=e=>{const{messageId:i,layerNodes:t=[],previewMapInfos:n,tableNodes:o,timelines:l,timezone:a,members:s,zIndexMap:c,layerFilters:f,projectTableNodes:v,isThirdPartyTable:m,thirdPartyInfoWindowCloseWay:h,resolution:y,mondayFirst:g,locale:b,adminBoundaryData:I}=e.data,C=new Set;Promise.allSettled(null===t||void 0===t?void 0:t.filter((e=>"map"===e.type)).map((async e=>{var i,t,D,F,k,w,O,M;let T=[],N=null;const P=n[e.id],S=(null===(i=e.mapInfo)||void 0===i?void 0:i.vectorTile)||!1,E=!(null===(t=e.vtInfo)||void 0===t||!t.publicLayer),L={...d()(P||e.mapInfo),vectorTile:S},B=null===I||void 0===I?void 0:I.find((i=>i.layerNodeId===e.id)),A=null===L||void 0===L?void 0:L.tableNodeID,x=null===o||void 0===o?void 0:o.find((e=>e.id===A)),R=null!==(D=null===x||void 0===x?void 0:x.type)&&void 0!==D?D:null===v||void 0===v||null===(F=v.find((e=>e.id===A)))||void 0===F?void 0:F.type,G=S?null===(k=e.vtInfo)||void 0===k?void 0:k.columns:null===x||void 0===x?void 0:x.columns,j=new Map(null===G||void 0===G?void 0:G.map((e=>[e.id,e]))),q=null!==L&&void 0!==L&&L.fillFieldID?j.get(L.fillFieldID):void 0,z=null!==L&&void 0!==L&&L.bivariateFillFieldID?j.get(L.bivariateFillFieldID):void 0,W=null!==L&&void 0!==L&&L.outlineFieldID?j.get(L.outlineFieldID):void 0,V=null!==L&&void 0!==L&&L.outlineWidthFieldID?j.get(L.outlineWidthFieldID):void 0,_=null!==L&&void 0!==L&&L.radiusFieldID?j.get(L.radiusFieldID):void 0,U=null!==L&&void 0!==L&&L.heightFieldID?j.get(L.heightFieldID):void 0,Y=f[e.id]||{};if(Ai(q)&&q){var H,Z;const e=(null===(H=q.typeOptions)||void 0===H?void 0:H.choices)||(null===(Z=q.typeOptions)||void 0===Z||null===(Z=Z.lookupColumnTypeOptions)||void 0===Z?void 0:Z.choices)||[];L.fillConfig={...L.fillConfig,_ordinalDomain:e.map((e=>e.id)),_ordinalColors:e.map((e=>null==e.color.id?X[e.color]:e.color.bgColor))}}if(Ai(W)&&W){var K,J;const e=(null===(K=W.typeOptions)||void 0===K?void 0:K.choices)||(null===(J=W.typeOptions)||void 0===J||null===(J=J.lookupColumnTypeOptions)||void 0===J?void 0:J.choices)||[];L.outlineConfig={...L.outlineConfig,_ordinalDomain:e.map((e=>e.id)),_ordinalColors:e.map((e=>null==e.color.id?X[e.color]:e.color.bgColor))}}const Q=null===l||void 0===l?void 0:l.find((i=>i.id===e.id)),$=null!==Q&&void 0!==Q&&Q.columnId?j.get(Q.columnId):void 0;if(S)L.fillConfig={...L.fillConfig,_quantiles:(0,Ce.yK)(q,e.vtInfo,y),_uniqDomain:(0,Ce.fi)(q,e.vtInfo)},L.bivariateFillConfig={...L.bivariateFillConfig,_quantiles:(0,Ce.yK)(z,e.vtInfo,y)},L.outlineConfig={...L.outlineConfig,_quantiles:(0,Ce.yK)(W,e.vtInfo,y),_uniqDomain:(0,Ce.fi)(W,e.vtInfo),_widthFiledQuantiles:(0,Ce.yK)(V,e.vtInfo,y)},L.radiusConfig={...L.radiusConfig,_quantiles:(0,Ce.yK)(_,e.vtInfo,y)},L.heightConfig&&(L.heightConfig={...L.heightConfig,_quantiles:(0,Ce.yK)(U,e.vtInfo,y)});else if("table"===R){const i=await async function(e){let{layer:i,tableNode:t,hiddenPoiIds:n,mapInfo:o,columns:l,filter:a,timelineColumn:d,members:s,timezone:c,filterRowsByView:f,mondayFirst:v,fillFieldScale:m,adminBoundary:h,locale:y="zh-CN"}=e;if(!t)return{features:[],hiddenPoiIds:n};const g=function(e,i,t){if(!t)return e.rows;if(i){var n;const t=null===(n=e.views)||void 0===n?void 0:n.find((e=>e.id===i));if(null!==t&&void 0!==t&&t.rows){var o;const i=Fe()(t.rows,(e=>e.id));return null===(o=e.rows)||void 0===o?void 0:o.filter((e=>i.includes(e.id)))}return e.rows}return e.rows}(t,o.viewID,f);if(null===g||void 0===g||!g.length)return{features:[],hiddenPoiIds:n};const b=null!==o&&void 0!==o&&o.coordinateFieldID?l.get(o.coordinateFieldID):void 0,I=null!==o&&void 0!==o&&o.latitudeFieldID?l.get(o.latitudeFieldID):void 0,C=null!==o&&void 0!==o&&o.fillFieldID?l.get(o.fillFieldID):void 0,D=null!==o&&void 0!==o&&o.destinationFieldID?l.get(o.destinationFieldID):void 0,F=null!==o&&void 0!==o&&o.destLatitudeFieldID?l.get(o.destLatitudeFieldID):void 0,k=null!==o&&void 0!==o&&o.heightFieldID?l.get(o.heightFieldID):void 0,w=null!==o&&void 0!==o&&o.bivariateFillFieldID?l.get(o.bivariateFillFieldID):void 0,O=null!==o&&void 0!==o&&o.outlineWidthFieldID?l.get(o.outlineWidthFieldID):void 0,M=null!==o&&void 0!==o&&o.radiusFieldID?l.get(o.radiusFieldID):void 0,T=null!==o&&void 0!==o&&o.weightFieldID?l.get(o.weightFieldID):void 0,N=null!==o&&void 0!==o&&o.outlineFieldID?l.get(o.outlineFieldID):void 0;let P;l.forEach((e=>{e.isPrimary&&(P=e)}));const S=[],E="h3"===o.layerType,L="icon"===o.layerType;let B=[];const A=a.view,x=be.and(...[a.row,a.layer,a.legend,a.extension,a.arbitrary].filter(Boolean)),R=new Xi(A,{mondayFirst:v,timezone:c}),G=new Xi(x,{mondayFirst:v,timezone:c}),j=Array.from(l.values());if("region"===o.layerType){if(!h||!h.data)return{features:[],hiddenPoiIds:n};const e=g.filter((e=>R.test(e.cells)&&G.test(e.cells))),{hideEmpty:i}=o.regionConfig;try{var q,z;const l=await Qe({locale:y,mapInfo:o,tableNode:{...t,rows:e},geojson:h.data,allIndexOptions:h.index}),r=i?null===(q=l.computingGeoJSON)||void 0===q?void 0:q.features.filter((e=>{var i;return null===(i=e.properties)||void 0===i?void 0:i.rowIds})):null===(z=l.computingGeoJSON)||void 0===z?void 0:z.features;return{features:null!==r&&void 0!==r?r:[],hiddenPoiIds:n,regionMatchResult:{notMatchedItems:l.notMatchedItems,totalItems:l.totalItems}}}catch(Z){return{features:[],hiddenPoiIds:n}}}if(L&&C&&(Li(C)||ji(C))){const e=C.id,i=new Set;for(let t=0,n=g.length;t<n;t++)i.add(g[t].cells[e]);B=Array.from(i).filter((e=>e)).sort(((e,i)=>e.length!==i.length?e.length-i.length:e.localeCompare(i,y)))}for(let r=0;r<g.length;r++){const e=g[r],a=$i(e.cells,d);if(-1===(R.test(e.cells)?1:-1))continue;const f=G.test(e.cells)?1:-1;if(-1===f&&(n.add(e.id),!it.includes(o.layerType)))continue;let v=st(e.cells[null===b||void 0===b?void 0:b.id],b);if(!v)continue;if(I){const i=st(e.cells[null===I||void 0===I?void 0:I.id],I);if(!i||!p()(i)||!p()(v))continue;v="POINT(".concat(v," ").concat(i,")")}let h=D?st(e.cells[D.id],D):void 0;if(h&&F){const i=st(e.cells[null===F||void 0===F?void 0:F.id],F);h=i&&p()(i)&&p()(h)?"POINT(".concat(h," ").concat(i,")"):void 0}try{var W,V,_;const n=E?Array.isArray(v)?v:[v]:void 0,r=ye(E?ut(n):v),d="Circle"===(null===r||void 0===r?void 0:r.type);let p="0";if(L&&C){if(Ai(C)&&(p=e.cells[C.id]),Bi(C)&&o.fillConfig.fillMethod&&m){var U;const i=e.cells[C.id],t=!Me()(i)&&m?m(i):"";p=null===(U=o.fillConfig.colors)||void 0===U?void 0:U.indexOf(t)}if(Li(C)||ji(C)){var Y,H;const i=e.cells[C.id],t=B.indexOf(i);p=null===(Y=o.fillConfig.colors)||void 0===Y?void 0:Y.indexOf(null===(H=o.fillConfig.colors)||void 0===H?void 0:H[t])}}const y=P?e.cells[P.id]:"",{label:g,tooltip:I}=at({columns:l,cells:e.cells,labelFieldIDs:o.labelFieldID?[o.labelFieldID].concat(null!==(W=o.extraLabelFieldIDs)&&void 0!==W?W:[]):[],items:o.labelConfig.items,timezone:c,members:s}),D={type:"Feature",geometry:tt(r),properties:u()({id:e.id,name:g||y,tooltip:I,tableNodeType:t.type,hexIds:n,["".concat(null===o||void 0===o?void 0:o.labelFieldID,"-labelFieldID")]:g,[null===o||void 0===o?void 0:o.fillFieldID]:st(e.cells[null===o||void 0===o?void 0:o.fillFieldID],C),[null===o||void 0===o?void 0:o.bivariateFillFieldID]:st(e.cells[null===o||void 0===o?void 0:o.bivariateFillFieldID],w),[null===o||void 0===o?void 0:o.radiusFieldID]:st(e.cells[null===o||void 0===o?void 0:o.radiusFieldID],M),[o.outlineFieldID]:st(e.cells[o.outlineFieldID],N),[null===o||void 0===o?void 0:o.outlineWidthFieldID]:st(e.cells[null===o||void 0===o?void 0:o.outlineWidthFieldID],O),[null===o||void 0===o?void 0:o.weightFieldID]:st(e.cells[null===o||void 0===o?void 0:o.weightFieldID],T),[null===o||void 0===o?void 0:o.destinationFieldID]:h?ye(h):void 0,[null===o||void 0===o?void 0:o.heightFieldID]:st(e.cells[null===o||void 0===o?void 0:o.heightFieldID],k),[o.timestampFieldID]:e.cells[o.timestampFieldID],[null===o||void 0===o?void 0:o.groupByFieldID]:e.cells[null===o||void 0===o?void 0:o.groupByFieldID],[null===o||void 0===o?void 0:o.sortByFieldID]:e.cells[null===o||void 0===o?void 0:o.sortByFieldID],tableNodeID:null===t||void 0===t?void 0:t.id,rowID:e.id,cellID:null===o||void 0===o?void 0:o.coordinateFieldID,latCellID:null===o||void 0===o?void 0:o.latitudeFieldID,subscribed:"subscribed"===(null===b||void 0===b?void 0:b.mode)||"connected"===(null===b||void 0===b?void 0:b.mode),editable:"coordinate"===(null===b||void 0===b?void 0:b.type)||"number"===(null===b||void 0===b?void 0:b.type),layerID:i.id,labelFieldID:null===o||void 0===o?void 0:o.labelFieldID,filterValue:f,timelineValue:a,radius:d?null===r||void 0===r?void 0:r.coordinates[2]:void 0,choicesId:p,fillFieldName:null===C||void 0===C?void 0:C.name,fillFieldID:null===C||void 0===C?void 0:C.id,fillAggregateBy:o.fillConfig.aggregateBy,enableHeight:null===(V=o.heightConfig)||void 0===V?void 0:V.toggle,heightFieldName:null===k||void 0===k?void 0:k.name,heightFieldID:null===k||void 0===k?void 0:k.id,heightAggregateBy:null===(_=o.heightConfig)||void 0===_?void 0:_.aggregateBy,rawCells:e.cells,rawColumns:j},((e,i)=>null==i))};S.push(D)}catch(Z){console.error(Z)}}o.timestampFieldID&&S.sort(((e,i)=>{var t,n;const l=null===(t=e.properties)||void 0===t?void 0:t[o.timestampFieldID],a=null===(n=i.properties)||void 0===n?void 0:n[o.timestampFieldID];return l&&a?r()(l).valueOf()-r()(a).valueOf():0}));return{features:S,hiddenPoiIds:n}}({layer:e,columns:j,hiddenPoiIds:C,tableNode:x,mapInfo:L,filter:Y,timelineColumn:$,members:s,timezone:a,mondayFirst:g,locale:b,filterRowsByView:m,fillFieldScale:ct(L.fillFieldID,L.coordinateFieldID,L.fillConfig.colors,L.fillConfig.fillMethod,x),adminBoundary:B});T=i.features,N=i.regionMatchResult,q&&(Li(q)||ji(q))&&(L.fillConfig={...L.fillConfig,_uniqDomain:(0,Ce.uT)(T,q.id)}),W&&(Li(W)||ji(W))&&(L.outlineConfig={...L.outlineConfig,_uniqDomain:(0,Ce.uT)(T,W.id)})}const ee=E?null===(w=e.vtInfo)||void 0===w||null===(w=w.infoWindowConfig)||void 0===w?void 0:w.closeWay:A?null===v||void 0===v||null===(O=v.find((e=>e.id===A)))||void 0===O||null===(O=O.infoWindowConfig)||void 0===O?void 0:O.closeWay:void 0,ie=m?h:ee;return{tableNodeId:A,tableNodeType:R,tableNodeUpdatedAt:null===x||void 0===x?void 0:x.lastUpdatedAt,type:"FeatureCollection",features:T,id:e.id,name:e.name,zIndex:null!==(M=c[e.id])&&void 0!==M?M:-e.order,mapInfo:L,vtInfo:e.vtInfo,timelineColumn:$,columns:G,members:s,timezone:a,layerFilter:Y,infoWindowCloseWay:ie,isPreview:!!P,regionMatchResult:N}}))).then((e=>e.map((e=>"rejected"===e.status?(console.error(e.reason),null):e.value)).filter((e=>e)))).then((e=>e.sort(((e,i)=>{var t,n;return(null!==(t=e.zIndex)&&void 0!==t?t:0)-(null!==(n=i.zIndex)&&void 0!==n?n:0)})))).then((e=>{dt.postMessage({messageId:i,computedLayers:e,hiddenPois:C})})).catch((e=>{console.error("Error processing layers:",e),dt.postMessage({messageId:i,computedLayers:[],hiddenPois:C})}))}}},i={};function t(n){var o=i[n];if(void 0!==o)return o.exports;var l=i[n]={id:n,loaded:!1,exports:{}};return e[n].call(l.exports,l,l.exports,t),l.loaded=!0,l.exports}t.m=e,t.x=()=>{var e=t.O(void 0,[973,130,980,698,21,54,911,298],(()=>t(3669)));return e=t.O(e)},(()=>{var e=[];t.O=(i,n,o,l)=>{if(!n){var r=1/0;for(u=0;u<e.length;u++){n=e[u][0],o=e[u][1],l=e[u][2];for(var a=!0,d=0;d<n.length;d++)(!1&l||r>=l)&&Object.keys(t.O).every((e=>t.O[e](n[d])))?n.splice(d--,1):(a=!1,l<r&&(r=l));if(a){e.splice(u--,1);var s=o();void 0!==s&&(i=s)}}return i}l=l||0;for(var u=e.length;u>0&&e[u-1][2]>l;u--)e[u]=e[u-1];e[u]=[n,o,l]}})(),t.n=e=>{var i=e&&e.__esModule?()=>e.default:()=>e;return t.d(i,{a:i}),i},(()=>{var e,i=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;t.t=function(n,o){if(1&o&&(n=this(n)),8&o)return n;if("object"===typeof n&&n){if(4&o&&n.__esModule)return n;if(16&o&&"function"===typeof n.then)return n}var l=Object.create(null);t.r(l);var r={};e=e||[null,i({}),i([]),i(i)];for(var a=2&o&&n;"object"==typeof a&&!~e.indexOf(a);a=i(a))Object.getOwnPropertyNames(a).forEach((e=>r[e]=()=>n[e]));return r.default=()=>n,t.d(l,r),l}})(),t.d=(e,i)=>{for(var n in i)t.o(i,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:i[n]})},t.f={},t.e=e=>Promise.all(Object.keys(t.f).reduce(((i,n)=>(t.f[n](e,i),i)),[])),t.u=e=>973===e?"static/js/973.b6c5f644.js":130===e?"static/js/130.a3d07413.js":980===e?"static/js/980.fe179d80.js":21===e?"static/js/21.7662a9ea.js":"static/js/"+({101:"lang-en-m",113:"lang-zh-CN",615:"lang-ja-JP",628:"lang-ja-JP-m",658:"lang-zh-CN-m",695:"lang-en"}[e]||e)+"."+{54:"78a94c14",101:"039f8755",113:"dbb3e40d",298:"aea3211d",615:"657dd279",628:"921fc45e",658:"b6a59aa8",695:"28dba274",698:"4d2febf4",911:"c6bbc63d"}[e]+".chunk.js",t.miniCssF=e=>{},t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),t.o=(e,i)=>Object.prototype.hasOwnProperty.call(e,i),t.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),t.p="./",(()=>{var e={995:1};t.f.i=(i,n)=>{e[i]||importScripts(t.p+t.u(i))};var i=self.webpackChunkmaptable_frontend=self.webpackChunkmaptable_frontend||[],n=i.push.bind(i);i.push=i=>{var o=i[0],l=i[1],r=i[2];for(var a in l)t.o(l,a)&&(t.m[a]=l[a]);for(r&&r(t);o.length;)e[o.pop()]=1;n(i)}})(),(()=>{var e=t.x;t.x=()=>Promise.all([973,130,980,698,21,54,911,298].map(t.e,t)).then(e)})();t.x()})();
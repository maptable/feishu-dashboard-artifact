(()=>{"use strict";var e={46131:(e,i,t)=>{t.d(i,{IG:()=>I,fi:()=>y,uT:()=>h,yK:()=>g});var n=t(74720),o=t.n(n),l=(t(7070),t(75538)),r=t.n(l),a=t(78587),d=t.n(a),s=t(75091),u=t.n(s),c=t(99540),p=t.n(c),f=(t(81659),t(21740),t(91671),t(42015),t(97102)),v=t.n(f);const m=201;function h(e,i){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m;const n=v()(e,(e=>{const t=b(e,i);return d()(t)?r()(t,","):u()(t)?t.id:t})),o=Object.keys(n);o.length>t&&o.slice(t).forEach((e=>delete n[e]));return["undefined","null",""].forEach((e=>delete n[e])),Object.keys(n).filter(Boolean).sort(((e,i)=>e.length!==i.length?e.length-i.length:e.localeCompare(i)))}function y(e,i){if(!e||null===i||void 0===i||!i.textQuantiles)return;const t=i.textQuantiles[e.id];return t?Object.keys(t):void 0}function g(e,i,t){var n,o,l,r,a;if(!e)return;if(!t||null===i||void 0===i||null===(n=i.metadata)||void 0===n||!n.quantiles)return null===i||void 0===i||null===(o=i.quantiles)||void 0===o?void 0:o[e.id];const d=i.metadata.quantiles[t];return d?null!==(r=d[e.id])&&void 0!==r?r:null===i||void 0===i||null===(a=i.quantiles)||void 0===a?void 0:a[e.id]:null===i||void 0===i||null===(l=i.quantiles)||void 0===l?void 0:l[e.id]}function b(e,i){return o()(null===e||void 0===e?void 0:e.properties,null!==i&&void 0!==i?i:"")}function I(e){return function(e){const i=[{value:1e9,symbol:"b"},{value:1e6,symbol:"m"},{value:1e3,symbol:"k"}];if(e<1e3)return e.toString();for(const t of i)if(e>=t.value){const i=e/t.value,n=Math.floor(i).toString().length,o=Math.max(0,4-n);return i.toFixed(o).replace(/\.?0+$/,"")+t.symbol}return e.toString()}(function(e){if(0!==e&&e>-.1&&e<1){let i,t=e;for(i=0;i<10&&t>-.1&&t<1;i++)t*=10;return parseFloat(e.toFixed(i+2))}return parseFloat(p()(e).toFixed(3))}(e))}},91671:(e,i,t)=>{t.d(i,{P:()=>o});const n={CNY:"zh-CN",USD:"en-US",EUR:"de-DE",GBP:"en-GB",AED:"ar-AE",AUD:"en-AU",BRL:"pt-BR",CAD:"en-CA",CHF:"de-CH",HKD:"zh-HK",INR:"en-IN",IDR:"id-ID",JPY:"ja-JP",KRW:"ko-KR",MOP:"zh-MO",MXN:"es-MX",MYR:"ms-MY",PHP:"en-PH",PLN:"pl-PL",RUB:"ru-RU",SGD:"en-SG",THB:"th-TH",TRY:"tr-TR",TWD:"zh-TW",VND:"vi-VN"};function o(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"number",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"USD";const l={minimumFractionDigits:i,maximumFractionDigits:i,useGrouping:"commaNumber"===t||"currency"===t,notation:(arguments.length>4?arguments[4]:void 0)?"compact":"standard"};if(null===e||"undefined"===typeof e||Number.isNaN(e))return;var r;if(String(e).toUpperCase().includes("E"))return null===e||void 0===e||null===(r=e.toExponential)||void 0===r?void 0:r.call(e,0===i?0:i-1);const a="currency"===t;if("percentage"===t)return(100*e).toLocaleString(void 0,l)+"%";if(a){const i=n[o]||"en-US";return e.toLocaleString(i,{...l,style:"currency",currency:o})}return"number"===typeof e?e.toLocaleString("en-US",l):e}},3669:(e,i,t)=>{var n,o=t(78062),l=t(43179),r=t.n(l),a=t(53813),d=t.n(a),s=t(23502),u=t.n(s),c=t(18878),p=t.n(c),f=t(88716),v=t.n(f),m=t(48828),h=t(86183),y=t(18263),g=t.n(y),b=t(74933),I=t.n(b),C=t(15288),k=t.n(C),D=t(65066),F=t.n(D),w=t(98968);const M=["maptableGreen1","maptableGreen2","maptablePink1","maptablePink2","maptablePink3","maptableBlue1"],O=["maptableBluePurple","maptableCyanBlack","maptableCyanGray","maptableRdBu"],T=["#E3F2E2","#BDDFD2","#99CDC2","#59A6A8","#3F9392","#267F7E","#086B6D","#00585D","#004548"],N=["#cdfcd7","#a9e4c9","#88cdba","#68b4ac","#499c9e","#35848d","#216d7d","#13546a","#073e58"],S=["#fff8bb","#ffe5a8","#ffd297","#ffbd89","#ffa87f","#ff927c","#ff7d7b","#f6677d","#ea5383"],P=["#f4e9a2","#fccf91","#ffb487","#fc9984","#f38088","#dd6c8f","#be5f98","#94559e","#5e4fa1"],E=["#eefc50","#ffc849","#fe946d","#f16b87","#db4486","#b61d7f","#850092","#520099","#130083"],L=["#59eefb","#4dd6ef","#40bde3","#34a4d7","#278bca","#4566c4","#5a3fbe","#6b0bb8","#7b00b3"],B=["#0083f8","#00a5cc","#00c5a1","#76c26d","#ffbe46","#ffa148","#ff824e","#e04a9f","#b900f8"],x=["#73c2a9","#c7dcc4","#eec4b4","#d46165","#c19280","#a7c39b","#7c6548","#442a1a","#050505"],A=["#55c5cb","#fcbe7b","#e8aad1","#81c679","#d3a0d0","#cfd385","#8dd2b7","#caa9aa","#b3b3b3"],R=["#1a79b3","#56e0c7","#8cc5dd","#bbe1e1","#bdf1d2","#ffffc5","#ffe1a0","#ffc07d","#fc9381","#ef5850","#e0203f"].reverse(),q=(T.length,{maptableGreen1:{3:T.slice(0,3),4:T.slice(0,4),5:T.slice(0,5),6:T.slice(0,6),7:T.slice(0,7),8:T.slice(0,8),9:T.slice(0,9)},maptableGreen2:{3:N.slice(0,3),4:N.slice(0,4),5:N.slice(0,5),6:N.slice(0,6),7:N.slice(0,7),8:N.slice(0,8),9:N.slice(0,9)},maptablePink1:{3:S.slice(0,3),4:S.slice(0,4),5:S.slice(0,5),6:S.slice(0,6),7:S.slice(0,7),8:S.slice(0,8),9:S.slice(0,9)},maptablePink2:{3:P.slice(0,3),4:P.slice(0,4),5:P.slice(0,5),6:P.slice(0,6),7:P.slice(0,7),8:P.slice(0,8),9:P.slice(0,9)},maptablePink3:{3:E.slice(0,3),4:E.slice(0,4),5:E.slice(0,5),6:E.slice(0,6),7:E.slice(0,7),8:E.slice(0,8),9:E.slice(0,9)},maptableBlue1:{3:L.slice(0,3),4:L.slice(0,4),5:L.slice(0,5),6:L.slice(0,6),7:L.slice(0,7),8:L.slice(0,8),9:L.slice(0,9)},maptableBluePurple:{3:B.slice(0,3),4:B.slice(0,4),5:B.slice(0,5),6:B.slice(0,6),7:B.slice(0,7),8:B.slice(0,8),9:B.slice(0,9)},maptableCyanBlack:{3:x.slice(0,3),4:x.slice(0,4),5:x.slice(0,5),6:x.slice(0,6),7:x.slice(0,7),8:x.slice(0,8),9:x.slice(0,9)},maptableCyanGray:{3:A.slice(0,3),4:A.slice(0,4),5:A.slice(0,5),6:A.slice(0,6),7:A.slice(0,7),8:A.slice(0,8),9:A.slice(0,9)},maptableRdBu:{3:R.slice(0,3),4:R.slice(0,4),5:R.slice(0,5),6:R.slice(0,6),7:R.slice(0,7),8:R.slice(0,8),9:R.slice(0,9),10:R.slice(0,10),11:R.slice(0,11)}}),G=["#008080","#31968c","#78ac99","#a3c2a6","#cdd8b3","#f7eec1","#f4d1a3","#efb386","#e7966a","#dd7750","#d25836"].reverse(),j=["#009b9d","#00acad","#40bdbd","#8ccdcf","#c2dfe0","#f1f1f1","#ebd4e2","#e5b7d3","#ef9ac4","#d77ab7","#cf5aaa"].reverse(),z={BrBG:{3:G.slice(0,3),4:G.slice(0,4),5:G.slice(0,5),6:G.slice(0,6),7:G.slice(0,7),8:G.slice(0,8),9:G.slice(0,9),10:G.slice(0,10),11:G.slice(0,11)},PiYG:{3:j.slice(0,3),4:j.slice(0,4),5:j.slice(0,5),6:j.slice(0,6),7:j.slice(0,7),8:j.slice(0,8),9:j.slice(0,9),10:j.slice(0,10),11:j.slice(0,11)}},W={...w.Z,...q,...z},{sequential:_=[],singlehue:V=[],diverging:U=[],qualitative:Y=[]}=null!==(n=null===w.Z||void 0===w.Z?void 0:w.Z.schemeGroups)&&void 0!==n?n:{},H=["BuGn","PuBu","PuBuGn","PuRd","RdPu","Pastel1","Set3","RdBu"],Z=[...M,...V,..._,...U,...Y,...O].filter((e=>!H.includes(e))),J=g()(3,12);function K(e,i){if(U.includes(e)){var t;const n=null===(t=W[e])||void 0===t?void 0:t[i];return n?[...n].reverse():n}return W[e][i]}k()(I()(J),(e=>F()(k()(I()(Z),(i=>K(i,e))))));const Q=["Set1","Set2","Spectral","YlGn","YlGnBu","YlOrBr","YlOrRd","Accent","Dark2","Paired","Pastel2","maptableCyanBlack","maptableCyanGray"],X=[...M,"Oranges","PRGn","RdYlGn","maptableBluePurple","maptableRdBu"],$=[...M,"Blues","Purples","Oranges","PRGn","RdYlBu","RdYlGn",...O];k()(I()(J),(e=>F()(k()(I()(Z.filter((e=>X.includes(e)))),(i=>K(i,e)))))),k()(I()(J),(e=>F()(k()(I()(Z.filter((e=>$.includes(e)))),(i=>K(i,e)))))),k()(I()(J),(e=>F()(k()(I()(Z.filter((e=>$.includes(e)))),(i=>K(i,e)))))),k()(I()(J),(e=>F()(k()(I()(Z.filter((e=>!Q.includes(e)))),(i=>K(i,e))))));const ee={...{redLighter:"#FADADA",salmonLighter:"#FBE7E2",orangeLighter:"#FEF0E3",yellowLighter:"#FFF8E0",greenLighter:"#E7F6F0",cyanLighter:"#E0F6FB",blueLighter:"#E0EDFF",purpleLighter:"#EDEAF8",lilacLighter:"#F6E5FC",greyLighter:"#EDEEF2",redLight:"#F5B6B6",salmonLight:"#F6C6BB",orangeLight:"#FDDCBE",yellowLight:"#FFEFB8",greenLight:"#C7EADB",cyanLight:"#B8EBF4",blueLight:"#B8D4FF",purpleLight:"#D4CFEE",lilacLight:"#EFCFFB",greyLight:"#E1E4EA"},redDark:"#E64C4C",salmonDark:"#E55939",orangeDark:"#F99439",yellowDark:"#FFC80A",greenDark:"#5EC298",cyanDark:"#46CBE2",blueDark:"#3384FF",purpleDark:"#8476CD",lilacDark:"#C043EF",greyDark:"#505F79"};var ie=t(37383),te=t(82086),ne=(t(40517),t(6778),t(27222),t(69820),t(17527),t(67045),t(22787));t(52675),t(58205);var oe=t(57323),le=t.n(oe);class re{constructor(e){le()(this,"i",0),this.raw=e}peek(){if(this.i>this.raw.length)throw new Error("unexpected EOF");return this.raw[this.i]}skipWs(){if(!(this.i>=this.raw.length))for(let e=this.i;e<this.raw.length;e++){if(!ae(this.raw.charAt(e)))return;this.i+=1}}scanStart(){this.skipWs();const e=this.peek();if("("!==e)throw new Error("expect '(' got ".concat(e));this.i++}scanContinue(){this.skipWs();const e=this.peek(),i=","===e;if(!i&&")"!==e)throw new Error("expect ',' or ')' got ".concat(e));return this.i++,i}scanCircle(){this.scanStart();const[e,i]=this.scanCoordinate();if(!i){const e=this.peek();throw new Error("expect ',' got ".concat(e))}this.i++,this.skipWs();const t=this.scanNumber(),n=this.peek();if(")"!==n)throw new Error("expect ')' got ".concat(n));return this.i++,[e[0],e[1],t]}scanCirlces(){this.scanStart();const e=[];for(;;){const i=this.scanCircle();e.push(i);if(!this.scanContinue())break}return e}scanNumber(){this.skipWs();let e="",i=this.peek();for(;de(i);)this.i+=1,e+=i,i=this.peek();const t=Number(e);if(Number.isNaN(t))throw new Error("number parse error ".concat(e));return t}scanCoordinate(){if(this.skipWs(),this.i>this.raw.length)throw new Error("unexpected EOF");const e=this.scanNumber();this.skipWs();const i=this.scanNumber();this.skipWs();const t=this.peek(),n=","===t;if(!n&&")"!==t)throw new Error("expect ',' or ')' got ".concat(t));return this.i++,[[e,i],n]}scanCoordinates(e){if(this.scanStart(),e)try{this.scanStart()}catch(t){e=!1}const i=[];for(;;){const[t,n]=this.scanCoordinate();if(i.push(t),!n){if(e){if(this.scanContinue()){this.scanStart();continue}}return i}if(e)throw new Error("expect ')' got ','")}}scanPolyData(e){this.scanStart();const i=[];for(;;){const t=this.scanCoordinates(!1);if(e){if(t.length<4)throw new Error("a polygon ring must have at least 4 points, got ".concat(t.length));if(t[0][0]!==t[t.length-1][0]||t[0][1]!==t[t.length-1][1])throw new Error("a polygon ring must be closed")}else if(t.length<2)throw new Error("must have at least 2 points, got ".concat(t.length));if(i.push(t),!this.scanContinue())return i}}scanMultiPolyData(){this.scanStart();const e=[];for(;;){const i=this.scanPolyData(!0);if(e.push(i),!this.scanContinue())return e}}scanIndent(){if(this.skipWs(),this.i>=this.raw.length)throw new Error("unexpected EOF");let e="",i=0;for(i=this.i;i<this.raw.length;i++){const t=this.raw.charAt(i);if(!se(t))break;e+=t.toUpperCase(),this.i+=1}if(0===e.length)throw new Error("indent not found");return e}scanGeometry(){const e=this.scanIndent();let i;switch(e){case"CIRCLE":i={type:"Circle",coordinates:this.scanCircle()};break;case"MULTICIRCLE":i={type:"MultiCircle",coordinates:this.scanCirlces()};break;case"POINT":{const e=this.scanCoordinates(!1);if(1!==e.length)throw new Error("expect 1 got ".concat(e.length," points"));i={type:"Point",coordinates:e[0]};break}case"MULTIPOINT":i={type:"MultiPoint",coordinates:this.scanCoordinates(!0)};break;case"LINESTRING":{const e=this.scanCoordinates(!1);if(e.length<2)throw new Error("must have at least 2 points, got ".concat(e.length));i={type:"LineString",coordinates:e};break}case"POLYGON":i={type:"Polygon",coordinates:this.scanPolyData(!0)};break;case"MULTIPOLYGON":i={type:"MultiPolygon",coordinates:this.scanMultiPolyData()};break;case"MULTILINESTRING":i={type:"MultiLineString",coordinates:this.scanPolyData(!1)};break;default:throw new Error("unknown geometry ".concat(e))}if(this.i+1<=this.raw.length)throw new Error("expect EOF");return i}}function ae(e){return 1===e.length&&[" ","\n","\t","\r"].includes(e)}function de(e){return[".","-","0","1","2","3","4","5","6","7","8","9"].includes(e)}function se(e){return 1===e.length&&e.match(/[a-zA-Z]/i)}var ue=t(82505),ce=(t(80128),t(31890),t(62953)),pe=t(64505);function fe(e,i){const[t,n,o]=i.coordinates;if("Point"===e.type){return(0,pe.Z)([t,n],e.coordinates,{units:"kilometers"})<=o/1e3}const l=o/1e3,r=l/111.32,a=l/(111.32*Math.cos(n*(Math.PI/180))),d=t-a,s=t+a,u=n-r,c=n+r,[p,f,v,m]=(0,te.Z)(e);if(v<d||p>s||m<u||f>c)return!1;if(p>=d&&v<=s&&f>=u&&m<=c){if([[p,f],[p,m],[v,f],[v,m]].every((e=>(0,pe.Z)([t,n],e,{units:"kilometers"})<=l)))return!0}let h=Math.round(16+6*Math.sqrt(l));return h=Math.max(16,Math.min(h,64)),(0,ue.Z)(e,(0,ce.Z)([t,n],l,{steps:h,units:"kilometers"}).geometry)}const{GCJ02:ve,WGS84:me,BD09MC:he}=ie.default;function ye(e){try{return function(e){return new re(e).scanGeometry()}(e)}catch{return}}function ge(e,i){try{const t=ye(e),n=ye(i);return!(!t||!n)&&function(e,i){if("MultiCircle"===i.type)return i.coordinates.map((e=>({type:"Circle",coordinates:e}))).some((i=>fe(e,i)));return"Circle"===i.type?fe(e,i):(0,ue.Z)(e,i)}(t,n)}catch(t){return!1}}const be=(()=>{function e(e){return!!e&&("and"in e&&Array.isArray(e.and))}function i(e){return!!e&&("or"in e&&Array.isArray(e.or))}function t(t){return t?e(t)?0===t.and.length?null:1===t.and.length?t.and[0]:t:i(t)?0===t.or.length?null:1===t.or.length?t.or[0]:t:t:null}function n(t){return t?e(t)?[t,...t.and.flatMap(n)]:i(t)?[t,...t.or.flatMap(n)]:[t]:[]}function o(t,n){return!!t&&(e(t)?t.and.every((e=>o(e,n))):i(t)?0===t.or.length||t.or.some((e=>o(e,n))):"op"in t&&n(t))}return{isEmpty:function t(n){return!n||("object"!==typeof n||(e(n)?!n.and.length||n.and.every(t):i(n)?!n.or.length||n.or.every(t):!("op"in n)&&!("id"in n)))},flat:n,compact:t,map:function t(n,o){return n?e(n)?{...n,and:n.and.map((e=>t(e,o))).filter(Boolean)}:i(n)?{...n,or:n.or.map((e=>t(e,o))).filter(Boolean)}:"op"in n||"id"in n?o(n):null:null},filter:function t(n,o){if(!n)return null;if(!e(n)&&!i(n))return o(n)?n:null;const l="and"in n?n.and:n.or,r=[];for(const a of l)if(e(a)||i(a)){const e=t(a,o);e&&r.push(e)}else a&&o(a)&&r.push(a);return"and"in n?{...n,and:r}:{...n,or:r}},filterGroup:function t(n,o){if(!n)return null;if(!o(n))return null;if(!e(n)&&!i(n))return n;const l="and"in n?n.and:n.or,r=[];for(const a of l)if(e(a)||i(a)){const e=t(a,o);e&&r.push(e)}else r.push(a);return"and"in n?{...n,and:r}:{...n,or:r}},every:function t(n,o){return!n||(e(n)?n.and.every((e=>t(e,o))):i(n)?n.or.every((e=>t(e,o))):o(n))},and:function(){for(var i=arguments.length,t=new Array(i),n=0;n<i;n++)t[n]=arguments[n];const o=t.filter((e=>!!e));if(0===o.length)return null;let l=o[0];for(let d=1;d<o.length;d++)r=l,a=o[d],l={and:[...e(r)?r.and:[r],...e(a)?a.and:[a]]};var r,a;return l},or:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const o=t.filter((e=>!!e));if(0===o.length)return null;let l=o[0];for(let d=1;d<o.length;d++)r=l,a=o[d],l={or:[...i(r)?r.or:[r],...i(a)?a.or:[a]]};var r,a;return l},append:function(t){for(var n=arguments.length,o=new Array(n>1?n-1:0),l=1;l<n;l++)o[l-1]=arguments[l];const r=o.filter((e=>!!e));return 0===r.length?t:e(t)?{...t,and:[...t.and,...r]}:i(t)?{...t,or:[...t.or,...r]}:{and:[t,...r]}},size:function(t,n){var o;return function t(n){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!n)return 0;if("object"!==typeof n)return 0;if("filter"in n&&v()(null===n||void 0===n?void 0:n.filter))return 0;if(e(n)||i(n)){const i=o>0&&!l?1:0,r=(e,i)=>e+t(i,o+1,l);return(e(n)?n.and.reduce(r,0):n.or.reduce(r,0))||i}return"id"in n||"op"in n?1:0}(t,0,null!==(o=null===n||void 0===n?void 0:n.ignoreEmptyGroup)&&void 0!==o&&o)},mutate:function t(n,o){if(!n.id||!o.id)return{result:n,found:!1};if(n.id===o.id)return{result:o,found:!0};if(!e(n)&&!i(n))return{result:n,found:!1};const l=n.id,r="and"in n?n.and:n.or;let a=!1;const d=r.map((e=>{if(a)return e;const i=t(e,o);return i.found?(a=!0,i.result):e}));return{result:"and"in n?{id:l,and:d}:{id:l,or:d},found:a}},test:(e,i)=>o(t(e),i),conjunction:function(e){return"or"in e?"or":"and"},flipTo:function(t,n){if(!t)return null;if(e(t)){const{and:e,...i}=t;return"or"===n?{...i,or:e}:t}if(i(t)){const{or:e,...i}=t;return"and"===n?{...i,and:e}:t}return t},find:function(e,i){return n(e).find(i)},depth:function(t){const n=t=>t?e(t)?1+Math.max(...t.and.map(n)):i(t)?1+Math.max(...t.or.map(n)):0:0;return Math.max(n(t),1)},groups:function t(n){return n?e(n)?n.and.reduce(((e,i)=>[...e,...t(i)]),[n]):i(n)?n.or.reduce(((e,i)=>[...e,...t(i)]),[n]):[]:[]},remove:function e(i,t){return i.id===t?null:"and"in i?{...i,and:i.and.map((i=>e(i,t))).filter(Boolean)}:"or"in i?{...i,or:i.or.map((i=>e(i,t))).filter(Boolean)}:i},children:function(t){return e(t)?[...t.and]:i(t)?[...t.or]:[]}}})();var Ie=t(79129);(0,Ie.vU)({is:{id:"filter.op.is",defaultMessage:"is"},isNot:{id:"filter.op.isNot",defaultMessage:"is not"},equals:{id:"filter.op.eq",defaultMessage:"equal to"},notEqual:{id:"filter.op.neq",defaultMessage:"not equal to"},startsWith:{id:"filter.op.startsWith",defaultMessage:"begins with"},endsWith:{id:"filter.op.endsWith",defaultMessage:"ends with"},lessThan:{id:"filter.op.lt",defaultMessage:"less than"},lessThanOrEqual:{id:"filter.op.lte",defaultMessage:"less than or equal to"},greaterThan:{id:"filter.op.gt",defaultMessage:"greater than"},greaterThanOrEqual:{id:"filter.op.gte",defaultMessage:"greater or equal to"},contains:{id:"filter.op.contains",defaultMessage:"contains"},containsAny:{id:"filter.op.containsAny",defaultMessage:"has any of"},containsAll:{id:"filter.op.containsAll",defaultMessage:"has all of"},notContains:{id:"filter.op.notContiains",defaultMessage:"has none of"},empty:{id:"filter.op.empty",defaultMessage:"is empty"},isNull:{id:"filter.op.isNull",defaultMessage:"is empty"},isNotNull:{id:"filter.op.isNotNull",defaultMessage:"is not empty"},inArea:{id:"filter.op.inArea",defaultMessage:"is in area"},isAfter:{id:"filter.op.after",defaultMessage:"is after"},isBefore:{id:"filter.op.before",defaultMessage:"is before"}});var Ce=t(46131),ke=t(7070),De=t.n(ke),Fe=t(18765),we=t.n(Fe),Me=t(55349),Oe=t.n(Me),Te=t(78587),Ne=t.n(Te),Se=t(20780),Pe=t(8942),Ee=t.n(Pe),Le=t(74720),Be=t.n(Le),xe=(t(34362),t(17646)),Ae=t.n(xe),Re=t(56356),qe=t.n(Re),Ge=t(468),je=t.n(Ge),ze=t(82813),We=t.n(ze),_e=t(42015),Ve=t(36441),Ue=t(40978),Ye=t(13424),He=t(29630),Ze=t(93033);const Je="optimized",Ke=("".concat("https://icon-cdn.maptable.com","/assets/boundary_data"),85);let Qe,Xe,$e=null;async function ei(e){var i;let{locale:t,mapInfo:n,tableNode:o,geojson:l,allIndexOptions:r,dashboardData:a}=e;const s=!Ee()($e,l),u=d()(l);if(u&&($e=u),"optimized"===Je&&"region"===(null===n||void 0===n||null===(i=n.regionConfig)||void 0===i?void 0:i.dimension))return await(0,Ze.l)({locale:t,mapInfo:n,tableNode:o,geojson:u,allIndexOptions:r,dashboardData:a,hasGeoJSONChanged:s});const c=[],p=[],{regionDimensionFieldID:f,regionIndexStatsFieldID:v,specifyByFieldID:m,regionConfig:h,latitudeFieldID:y}=n,{dimension:g,aggregateBy:b,regionId:I,indexStatsMethod:C}=h;if(!f||!v||!u||!o)return null===u||void 0===u||u.features.map((e=>(e.properties=je()(e.properties,["aggregationValue","aggregationFormatValue"]),e))),{computingGeoJSON:u};(Qe&&!Ee()(f,Qe)||Xe&&!Ee()(v,Xe))&&(null===u||void 0===u||u.features.map((e=>(e.properties=je()(e.properties,["aggregationValue","aggregationFormatValue"]),e)))),Qe=f,Xe=v;const k=I||"china";if("region"===g){const e=We()(r),i=new Se.Z(e,_e.Hk),n=new Se.Z(e,_e.Yk),l=o.rows||[],d=o.columns||[],h=JSON.stringify((null===d||void 0===d?void 0:d.find((e=>e.id===v)))||{}),y=d.find((e=>e.id===f)),g=d.find((e=>e.id===m)),I=new Map,S=new Map(u.features.map((e=>{var i;return[null===(i=e.properties)||void 0===i?void 0:i.id,e]}))),P=new Map(e.map((e=>[e.id,e.parentId]))),E=!!g;let L=[],B=C||"sum";a?(Ae()(a,((e,i)=>{Ae()(e,((e,t)=>{L.push({regionName:qe()(i),specifyByName:E?t:null,value:e.value,dashboardValue:"mean"===B?e:void 0,rowId:i})}))})),"count"!==C&&"nonEmptyCount"!==C||(B="sum")):L=l.reduce(((e,i,t)=>{const n=(0,Ye.hb)(i,y);if(!n)return e;const o=i.cells[v],l=i.id;return e.push({regionName:n,specifyByName:(0,Ye.hb)(i,g),value:o,rowId:l}),e}),[]),p.push(...L);const x=await(0,He.zK)(k),A=new Set(L.map((e=>"".concat(e.regionName,"-").concat(e.specifyByName||"","-").concat(b||"")))),R=await Promise.all([...A].map((e=>(0,He.TK)(e,x)))),q=new Map([...A].map(((e,i)=>[e,R[i]]))),G={};for(const t of L){var D;if(t.regionName&&t.regionName.length>Ke){c.push(t);continue}const e="".concat(t.regionName,"-").concat(t.specifyByName||"","-").concat(b||"");let o=q.get(e);if(o||s){var F;const l=await(0,Ye.Lu)(t.regionName,n,i);if(null===l||void 0===l||!l.length){G[e]=null;continue}o=await(0,Ye.XN)({directFuzzyMatchResult:l,specifyMatchValue:t.specifyByName,strictFUse:n,fuzzyFUse:i,aggregateBy:b}),((null===(F=o)||void 0===F?void 0:F.score)||0)>_e.a&&(o=null),q.set(e,o||null),G[e]=o||null}if(Oe()(o)){c.push(t);continue}const l=null===(D=o.item)||void 0===D?void 0:D.id;if(!l){c.push(t);continue}const r=t.value,a=t.rowId;I.has(l)||I.set(l,[]),I.get(l).push({value:r,rowId:a,dashboardValue:t.dashboardValue});let d=l;for(let i=0;i<2;i++){const e=P.get(d);if(!e)break;I.has(e)||I.set(e,[]),I.get(e).push({value:r,rowId:a,dashboardValue:t.dashboardValue}),d=e}}await(0,He.Iv)(G,x);for(const[o,r]of I){var w,M,O;const e=S.get(o);if(!e)continue;if(o===Ve.q)continue;const i="zh-CN"===t?(null===(w=e.properties)||void 0===w?void 0:w.display_name)||(null===(M=e.properties)||void 0===M?void 0:M.name_zh):null===(O=e.properties)||void 0===O?void 0:O.name_en;e.type="Feature";const n=(0,Ye.vg)(r,B);e.properties={...e.properties||{},name:i,aggregationValue:n,aggregationMethod:B,rowIds:r.map((e=>e.rowId)),indexStatsColumn:h}}const j=Array.from(I.keys()).map((e=>S.get(e))).filter((e=>{var i;return void 0!==e&&(null===(i=e.properties)||void 0===i?void 0:i.id)!==Ve.q})),{valueMap:z,totalSum:W,rankMap:_}=(0,Ye.Hr)(j,[Ve.q]);for(const[t]of I){var T,N;const e=S.get(t);if(!e||t===Ve.q)continue;const i=null===(T=e.properties)||void 0===T?void 0:T.name,n=null===(N=e.properties)||void 0===N?void 0:N.aggregationValue,o=z.get(t)||0,l=0!==W?o/W*100:null,r=_.get(t)||null,a=(0,Ye.gB)({aggregationValue:n,indexStatsMethod:C,columns:d,regionIndexStatsFieldID:v,name:i,ratio:l,rank:r});e.properties={...e.properties||{},ratio:l,rank:r,tooltip:a}}}else if("coordinate"===g||"lng-lat"===g||"wkt"===g){const e=o.rows,i=o.columns,n=new Map,l=JSON.stringify((null===i||void 0===i?void 0:i.find((e=>e.id===v)))||{});for(const o of e){let e=o.cells[f];if(e)try{"lng-lat"===g&&o.cells[y||""]&&(e="POINT(".concat(e," ").concat(o.cells[y||""],")"));const i=(0,Ue.HF)(e);if("Point"!==i.type)continue;let r=!1;p.push({regionName:o.cells[f],specifyByName:null,value:0,rowId:o.id});for(const e of u.features){const a="zh-CN"===t?Be()(e,"properties.display_name")||Be()(e,"properties.name_zh"):Be()(e,"properties.name_en");if((0,ne.Z)(i.coordinates,e)){var S,P,E;const i=null===(S=e.properties)||void 0===S?void 0:S.id;n.has(i)||n.set(i,[]),n.get(i).push({value:o.cells[v],rowId:o.id});const t=(null===(P=n.get(i))||void 0===P?void 0:P.map((e=>e.value)))||[];e.type="Feature",e.properties={...e.properties||{},name:a,aggregationValue:t,aggregationMethod:C,rowIds:(null===(E=n.get(i))||void 0===E?void 0:E.map((e=>e.rowId)))||[],indexStatsColumn:l},r=!0;break}}r||c.push({rowId:o.id,regionName:Be()(o.cells,"".concat(f,"-fullAddress"),o.cells[f]),value:0,specifyByName:null})}catch{continue}}}const{valueMap:L,totalSum:B,rankMap:x}=(0,Ye.Hr)(u.features,[Ve.q]),A=(null===o||void 0===o?void 0:o.columns)||[];for(const d of u.features){var R,q,G;const e=null===(R=d.properties)||void 0===R?void 0:R.id;if(!e||e===Ve.q)continue;const i=null===(q=d.properties)||void 0===q?void 0:q.aggregationValue,t=null===(G=d.properties)||void 0===G?void 0:G.name;if(!i||!t)continue;const n=L.get(e)||0,o=0!==B?n/B*100:null,l=x.get(e)||null,r=(0,Ye.gB)({aggregationValue:i,indexStatsMethod:C,columns:A,regionIndexStatsFieldID:v,name:t,ratio:o,rank:l});d.properties={...d.properties||{},ratio:o,rank:l,tooltip:r}}return{computingGeoJSON:u,notMatchedItems:c,totalItems:p}}t(57435);var ii=t(56439),ti=t.n(ii),ni=t(99540),oi=t.n(ni),li=t(62618),ri=t.n(li),ai=t(57889),di=t.n(ai),si=t(42552),ui=t(31343);t(84527);const ci=1e6,pi={is:{key:"is"},isNot:{key:"isNot"},equals:{key:"equals",mark:"="},notEqual:{key:"notEqual",mark:"\u2260"},startsWith:{key:"startsWith"},endsWith:{key:"endsWith"},lessThan:{key:"lessThan",mark:"<"},lessThanOrEqual:{key:"lessThanOrEqual",mark:"\u2264"},greaterThan:{key:"greaterThan",mark:">"},greaterThanOrEqual:{key:"greaterThanOrEqual",mark:"\u2265"},contains:{key:"contains"},containsAny:{key:"contains"},containsAll:{key:"containsAll"},notContains:{key:"notContains"},empty:{key:"empty"},isNull:{key:"isNull"},isNotNull:{key:"isNotNull"},inArea:{key:"inArea"},inRange:{key:"inRange"},notInRange:{key:"notInRange"},isAfter:{key:"isAfter"},isBefore:{key:"isBefore"}};let fi=function(e){return e.is="is",e.isNot="isNot",e.equals="equals",e.notEqual="notEqual",e.startsWith="startsWith",e.endsWith="endsWith",e.lessThan="lessThan",e.lessThanOrEqual="lessThanOrEqual",e.greaterThan="greaterThan",e.greaterThanOrEqual="greaterThanOrEqual",e.contains="contains",e.containsAll="containsAll",e.notContains="notContains",e.empty="empty",e.inRange="inRange",e.inArea="inArea",e.isNull="isNull",e.isNotNull="isNotNull",e.notInRange="notInRange",e.isBefore="isBefore",e.isAfter="isAfter",e}({});Object.keys(pi);var vi=t(91671),mi=t(75538),hi=t.n(mi),yi=(t(23903),t(46881),t(92626)),gi=t.n(yi),bi=t(58674),Ii=t.n(bi);const Ci=["multiLineText","coordinate","number","singleChoice","multiChoice","datetime","attachment","boolean","createTime","updateTime","formula","creator","updater","member","hyperlink","related","lookup"];Ii()(Ci,"multiLineText","coordinate","number","singleChoice","multiChoice","datetime","attachment","boolean","hyperlink"),Ii()(Ci,"related","lookup");t(65235);const ki={"year/month/day":"YYYY/MM/DD","month/day/year":"MM/DD/YYYY",detail:"YYYY-M-DD"},Di={"12-hour-clock":"h:mm","24-hour-clock":"HH:mm",hidden:""};(0,Ie.vU)({days:{id:"UA5qaX",defaultMessage:"{days, plural, one {# day} other {# days}}"}});(0,t(64201).Sn)();var Fi=t(7336),wi=t.n(Fi),Mi=t(83177),Oi=t.n(Mi);function Ti(e,i){return i?e.tz(i):e}r().extend(wi()),r().extend(Oi());const Ni=(()=>{const e={};return function(i){if(i in e)return e[i];const t="Invalid Date"!==new Date(i).toString();return e[i]=t,t}})(),Si=(()=>{const e=Object.keys(ki)[0],i=Object.keys(ki)[2],t={};return function(n,o,l){var a,d;if(!Ni(n))return n?String(n):"";const s=null!==(a=null===o||void 0===o?void 0:o.dateFormat)&&void 0!==a?a:e,u=null!==(d=null===o||void 0===o?void 0:o.timeFormat)&&void 0!==d?d:i,c="12-hour-clock"===u?" A":"",p=null!==o&&void 0!==o&&o.showTimezone?" ([GMT] Z)":"";let f="".concat(Di[u]||"").concat(c).concat(p);const v=ki[s];v&&(f=v+" "+f);const m="".concat(n,"/").concat(f,"/").concat(l||"");if(m in t)return qe()(t[m]);const h=r()(n);return t[m]=Ti(h,l).format(f),qe()(t[m])}})();function Pi(e){let{type:i,typeOptions:t}=e;return"formula"===i&&"multiLineText"===(null===t||void 0===t?void 0:t.expectedType)}function Ei(e){let{type:i,typeOptions:t}=e;return"lookup"===i&&!(null===t||void 0===t||!t.lookupResultType)&&"original"!==t.lookupResultType&&"distinct"!==t.lookupResultType}function Li(e){let{type:i,typeOptions:t}=e;return"lookup"===i&&("original"===(null===t||void 0===t?void 0:t.lookupResultType)||"distinct"===(null===t||void 0===t?void 0:t.lookupResultType))}function Bi(e){return!!e&&("number"===e.type||function(e){let{type:i,typeOptions:t}=e;return"formula"===i&&"number"===(null===t||void 0===t?void 0:t.expectedType)}(e)||Ei(e))}function xi(e){return!!e&&("multiLineText"===e.type||function(e){let{type:i,typeOptions:t}=e;return"lookup"===i&&("original"===(null===t||void 0===t?void 0:t.lookupResultType)||"distinct"===(null===t||void 0===t?void 0:t.lookupResultType))&&"coordinate"!==t.lookupColumnType&&"attachment"!==t.lookupColumnType&&"singleChoice"!==t.lookupColumnType&&"number"!==t.lookupColumnType}(e)||Pi(e))}function Ai(e){return!!e&&(Bi(e)||function(e){var i;return Li(e)&&("number"===e.typeOptions.lookupColumnType||"formula"===e.typeOptions.lookupColumnType&&"number"===(null===(i=e.typeOptions.lookupColumnTypeOptions)||void 0===i?void 0:i.expectedType))}(e))}function Ri(e){var i,t;return!!e&&(function(e){return!!e&&"singleChoice"===e.type}(e)||"singleChoice"===(null===(i=e.typeOptions)||void 0===i?void 0:i.lookupColumnType)||"singleChoice"===(null===(t=e.typeOptions)||void 0===t?void 0:t.expectedType))}function qi(e){let{type:i,typeOptions:t}=e;return"datetime"===i||"updateTime"===i||"createTime"===i||"formula"===i&&"datetime"===(null===t||void 0===t?void 0:t.expectedType)||"lookup"===i&&"datetime"===(null===t||void 0===t?void 0:t.lookupColumnType)}function Gi(e){return"related"===e.type}function ji(e){let{type:i,typeOptions:t}=e;return"creator"===i||"updater"===i||function(e){var i,t,n;return"lookup"===(null===e||void 0===e?void 0:e.type)&&("member"===(null===e||void 0===e||null===(i=e.typeOptions)||void 0===i?void 0:i.lookupColumnType)||"creator"===(null===e||void 0===e||null===(t=e.typeOptions)||void 0===t?void 0:t.lookupColumnType)||"updater"===(null===e||void 0===e||null===(n=e.typeOptions)||void 0===n?void 0:n.lookupColumnType))}({type:i,typeOptions:t})}function zi(e){return!!e&&(ji(e)||"member"===e.type)}function Wi(e,i,t,n){var o,l;let r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const a=null===i||void 0===i?void 0:i.type,d=null===i||void 0===i?void 0:i.typeOptions;if("singleChoice"===a||"multiChoice"===a||"singleChoice"===(null===i||void 0===i||null===(o=i.typeOptions)||void 0===o?void 0:o.expectedType)||"lookup"===a&&("singleChoice"===(null===d||void 0===d?void 0:d.lookupColumnType)||"multiChoice"===(null===d||void 0===d?void 0:d.lookupColumnType))){var s,u,c;const i=null!==(s=null!==(u=null===d||void 0===d?void 0:d.choices)&&void 0!==u?u:null===d||void 0===d||null===(c=d.lookupColumnTypeOptions)||void 0===c?void 0:c.choices)&&void 0!==s?s:[];return hi()(De()(ti()(e,","),(e=>{var t,n;return null!==(t=null===(n=i.find((i=>i.id===e)))||void 0===n?void 0:n.name)&&void 0!==t?t:""})))}if("attachment"===a)return hi()(De()(e,(e=>e.url)));if("multiLineText"===a&&r){const i=new(gi())([[e]]).encode(),t=i.slice(1,-1);return t.match(/[\n\t"]/gm)?i:t}if("boolean"===a)return e?"True":"False";var f,v,m;if("number"===a)return p()(e)?(0,vi.P)(e,null!==(f=null===d||void 0===d?void 0:d.precision)&&void 0!==f?f:0,null===d||void 0===d?void 0:d.format):e;if("formula"===a){var h;if("number"===(null===d||void 0===d?void 0:d.expectedType)&&null!==e)return(0,vi.P)(oi()(e),null!==(h=null===d||void 0===d?void 0:d.numberPrecision)&&void 0!==h?h:0,null===d||void 0===d?void 0:d.numberFormat);if("multiLineText"===(null===d||void 0===d?void 0:d.expectedType)&&r){const i=new(gi())([[e]]).encode(),t=i.slice(1,-1);return t.match(/[\n\t"]/gm)?i:t}if(null!==e&&Array.isArray(e))return e.map((e=>e.text)).join(",")}if("member"===a)return hi()(De()(e,(e=>{var i,n;return null!==(i=null===t||void 0===t||null===(n=t.find((i=>i.id===e)))||void 0===n?void 0:n.name)&&void 0!==i?i:""})));if("updater"===a||"creator"===a)return null!==(v=null!==(m=null===e||void 0===e?void 0:e.name)&&void 0!==m?m:hi()(De()(e,(e=>{var i,n;return null!==(i=null===t||void 0===t||null===(n=t.find((i=>i.id===e)))||void 0===n?void 0:n.name)&&void 0!==i?i:""}))))&&void 0!==v?v:"";if("related"===a)return hi()(De()(e,(e=>{var i;return null!==(i=null===e||void 0===e?void 0:e.displayName)&&void 0!==i?i:""})));if("lookup"===a)switch(null===d||void 0===d?void 0:d.lookupColumnType){case"number":return hi()(De()(e,(e=>{var i;return p()(e)?(0,vi.P)(e,null!==(i=null===d||void 0===d?void 0:d.precision)&&void 0!==i?i:0,null===d||void 0===d?void 0:d.format):e})));case"updater":case"creator":case"member":return hi()(De()(e,(e=>{var i,n;return null!==(i=null===t||void 0===t||null===(n=t.find((i=>i.id===e)))||void 0===n?void 0:n.name)&&void 0!==i?i:""})));case"singleChoice":case"multiChoice":return hi()(De()(ti()(e,","),(e=>{var i,t;return null!==(i=null===d||void 0===d||null===(t=d.lookupColumnTypeOptions)||void 0===t||null===(t=t.choices)||void 0===t||null===(t=t.find((i=>i.id===e)))||void 0===t?void 0:t.name)&&void 0!==i?i:""})));case"datetime":case"createTime":case"updateTime":return hi()(De()(e,(e=>Oe()(e)?"":Si(e,null===d||void 0===d?void 0:d.lookupColumnTypeOptions,n))));case"related":return hi()(De()(e,(e=>{var i;return null!==(i=null===e||void 0===e?void 0:e.displayName)&&void 0!==i?i:""})));case"formula":switch(null===d||void 0===d||null===(l=d.lookupColumnTypeOptions)||void 0===l?void 0:l.expectedType){case"datetime":return hi()(De()(e,(e=>{var i,t,o;return Oe()(e)?"":Si(e,{dateFormat:null===d||void 0===d||null===(i=d.lookupColumnTypeOptions)||void 0===i?void 0:i.datetimeDateFormat,timeFormat:null===d||void 0===d||null===(t=d.lookupColumnTypeOptions)||void 0===t?void 0:t.datetimeTimeFormat,showTimezone:null===d||void 0===d||null===(o=d.lookupColumnTypeOptions)||void 0===o?void 0:o.showTimezone},n)})));case"number":return hi()(De()(e,(e=>{var i;return p()(e)?(0,vi.P)(e,null!==(i=null===d||void 0===d?void 0:d.precision)&&void 0!==i?i:0,null===d||void 0===d?void 0:d.format):e})))}return hi()(e);default:return Array.isArray(e)?hi()(e):e}return null!==e&&void 0!==e?e:""}var _i=t(14083);let Vi=function(e){return e.ProjectPage="readonly",e.ProjectEdit="admin",e.ProjectDuplicate="admin",e.Collaborator="readonly",e.CollaboratorEdit="admin",e.CollaboratorInvite="admin",e.CollaboratorRemove="admin",e.CollaboratorQuit="readonly",e.ProjectDelete="admin",e.ProjectTransfer="owner",e.ProjectRecycleBinPage="readonly",e.ProjectSetting="admin",e.RecycleBinRecover="admin",e.RecycleBinDelete="admin",e.TableSiderPlusButton="editable",e.NewTable="editable",e.NewFolder="editable",e.ImportData="editable",e.TableFolderRename="editable",e.TableFolderDelete="editable",e.MapSiderPlusButton="editable",e.NewMapLayer="editable",e.NewMapFolder="editable",e.MapSetting="editable",e.MapFolderRename="editable",e.MapFolderDelete="editable",e.MapLayerRename="editable",e.MapLayerSetting="editable",e.MapLayerViewTable="readonly",e.MapLayerDelete="admin",e.MapShare="admin",e.ProjectShare="admin",e.SiderHelp="readonly",e.TreeItemDraggable="editable",e.MapSearch="readonly",e.DashboardEdit="admin",e.DashboardShare="admin",e.TableViewCreate="editable",e.AnnotationEditable="editable",e.CreateH3Tile="admin",e}({}),Ui=function(e){return e.TablePage="readonly",e.MemberInvite="admin",e.ProjectRecycleBinActions="admin",e.MenuItemRename="editable",e.MenuItemMember="readonly",e.MenuItemDuplicate="admin",e.MenuItemDelete="admin",e.MenuItemSync="admin",e.GridHideColumn="editable",e.GridFilter="readonly",e.GridSorting="readonly",e.GridGrouping="readonly",e.GridRowHeight="editable",e.GridSearch="readonly",e.GridExport="editable",e.GridSnapshot="editable",e.LayerControl="readonly",e.MapFilter="readonly",e.MapNearBy="readonly",e.MapExport="editable",e.ViewShare="editable",e.FormFieldEdit="editable",e.RowShare="editable",e.InfoWindowConfig="admin",e.DetailPanelConfig="admin",e.DetailPanelShare="editable",e.DataEdit="editable",e.MapLayerSetting="editable",e.LockView="admin",e.ReassignView="admin",e.LockField="admin",e.LockTable="admin",e}({});Vi.NewMapLayer,Vi.NewMapFolder,Vi.NewMapLayer,Vi.ImportData,Vi.ImportData,Vi.ImportData,Vi.ImportData,Vi.ImportData,Vi.NewMapLayer,Vi.NewMapFolder,Vi.NewMapLayer,Vi.MapFolderRename,Vi.MapFolderDelete,[{action:"fitBounds",key:"fitBounds"},{action:"showThisLayerOnly",key:"showThisLayerOnly"},{isDivider:!0},{action:"openLayerSetting",key:"openLayerSetting"},{key:"divider",isDivider:!0},{action:"editItem",key:"editItem",permission:Vi.MapLayerRename},{action:"replicate",key:"duplicate",permission:Vi.NewMapLayer},null,{isDivider:!0},{action:"conv2vector",key:"conv2vector",permission:Vi.NewMapLayer,tooltip:(0,_i.Em)({id:"8z1uai",defaultMessage:"Vector tiles significantly improve map layer loading performance when processing large-scale datasets. <a>Learn more about Vector tiles.</a>"}),link:"conv2vector",plan:"ent"},{action:"vtRecreate",key:"vtRecreate",permission:Vi.NewMapLayer,plan:"ent"},{action:"publishLayer",key:"publishLayer",permission:Vi.MapShare},{action:"deleteItem",key:"delete",type:"danger",permission:Vi.MapLayerDelete}].filter(Boolean),Vi.NewTable,Vi.NewFolder,Vi.ImportData,Vi.ImportData,Vi.ImportData,Vi.ImportData,Vi.ImportData,Vi.ImportData,(0,_i.Em)({id:"N455eL",defaultMessage:"Subscribe to publicly shared data tables from other collaborators to keep synced tables aligned with the source data. <a>Learn more about Maptable sync table.</a>"}),Vi.ImportData,Vi.TableFolderRename,Vi.NewTable,Vi.TableFolderDelete,Ui.MenuItemRename,Ui.MenuItemMember,Ui.MenuItemDuplicate,Ui.MenuItemDelete,Ui.MenuItemRename,Ui.MenuItemMember,Ui.MenuItemSync,Ui.MenuItemSync,Ui.MenuItemDelete,Ui.MenuItemRename,Ui.MenuItemMember,Ui.MenuItemDelete,Vi.ProjectEdit,Vi.Collaborator,Ui.DataEdit,Ui.DataEdit;function Yi(e){let{date:i,typeOptions:t,isGpuDatetime:n}=e;if(null!==t&&void 0!==t&&t.dateFormat&&null!==t&&void 0!==t&&t.timeFormat){const e=i&&n&&"number"===typeof i?i*ci:i;return r()(e).valueOf()}return i&&Ni(i)?r()(i).valueOf():oi()(i)}const Hi=e=>{if(!e)return"";let i=[],t=[];try{"string"===typeof e?i=JSON.parse(e):"object"===typeof e&&(i=e),t=i.map((e=>e.displayName))}catch(n){return""}return String(ri()(t)).toLowerCase()},Zi=(e,i,t)=>{var n;if("datetime"===(null===i||void 0===i?void 0:i.lookupColumnType)||"formula"===(null===i||void 0===i?void 0:i.lookupColumnType)&&"datetime"===(null===i||void 0===i||null===(n=i.lookupColumnTypeOptions)||void 0===n?void 0:n.expectedType)){return null===(Array.isArray(e)?1===e.length?e[0]:null:e)?NaN:Yi({date:e,typeOptions:null===i||void 0===i?void 0:i.lookupColumnTypeOptions,isGpuDatetime:t})}return"related"===(null===i||void 0===i?void 0:i.lookupColumnType)?Hi(e):String(Ji(e)).toLowerCase()};function Ji(e){return Array.isArray(e)?ri()(e).join(","):e}const Ki=/^P(-)?(\d+Y)?(\d+Q)?(\d+M)?(\d+W)?(\d+D)?(=)?$/;function Qi(e){return Array.isArray(e)&&e.length>0&&"key"in e[0]}function Xi(e,i,t,n){if(null==e)switch(t){case fi.isNot:case fi.notEqual:case fi.notContains:case fi.isNull:return!0;default:return!1}switch(t){case fi.equals:return e===n||""===n;case fi.notEqual:return e!==n;case fi.is:if(i.datetime&&(o=n,Array.isArray(o)&&o.length>0&&"number"===typeof o[0])){const i=+e,[t,o]=n;return t<=i&&i<=o}return e===n;case fi.isNot:return e!==n;case fi.startsWith:return 0===String(e).indexOf(n);case fi.endsWith:return String(e).lastIndexOf(String(n))===String(e).length-String(n).length;case fi.isBefore:case fi.lessThan:return oi()(e)<oi()(n);case fi.lessThanOrEqual:return oi()(e)<=oi()(n);case fi.isAfter:case fi.greaterThan:return oi()(e)>oi()(n);case fi.greaterThanOrEqual:return oi()(e)>=oi()(n);case fi.contains:return i.choice||i.user||i.lookupUser||i.lookupChoice?String(n).split(",").some((i=>String(e).split(",").includes(i))):String(e).indexOf(String(n))>=0;case fi.containsAll:return String(e).indexOf(String(n))>=0;case fi.notContains:return i.choice||i.lookupChoice||i.user?!String(n).split(",").some((i=>String(e).split(",").includes(i))):-1===String(e).indexOf(String(n));case fi.isNull:return i.number?isNaN(oi()(e))||"undefined"===typeof e:!e;case fi.isNotNull:return i.number?!isNaN(oi()(e))&&"undefined"!==typeof e:!!e;case fi.inArea:return ge(String(e),String(n));case fi.inRange:{if(!Qi(n))return!!e;const t=i.choice||i.lookupChoice?tt(e):e;return n.every((e=>oi()(t)>=e.values[0]&&oi()(t)<=e.values[1]))}case fi.notInRange:{if(!Qi(n))return!!e;const t=i.choice||i.lookupChoice?tt(e):e;return n.every((e=>oi()(t)<e.values[0]||oi()(t)>e.values[1]))}default:return!0}var o}function $i(e,i,t){const n=e.value;if(void 0===n)return n;const o=null===t||void 0===t?void 0:t.now,l=null===t||void 0===t?void 0:t.useGPU,a=null===t||void 0===t?void 0:t.timezone,d=e.field.typeOptions,s=null===t||void 0===t?void 0:t.mondayFirst,u=e.op.key;if(i.datetime&&u===fi.is){const e=function(e){let{s:i,now:t=r()(),mondayFirst:n=!1,timezone:o}=e;if("string"!==typeof i)return null;if("P"!==i[0])return null;if(i.length<3)return null;const l=i.match(Ki);if(!l)return null;const a="-"===l[1]?-1:1,d="="===l[l.length-1],[s,u,c,p,f]=l.slice(2).map((e=>e?parseInt(e.slice(0,-1)):null)),v=Ti(t,o),m=v.startOf("day");if(null!==s){const e=v.add(a*s,"year");return d?[e,m]:[e.startOf("year"),e.endOf("year")]}if(null!==u){const e=v.add(a*u,"quarter");return d?[e,m]:[e.startOf("quarter"),e.endOf("quarter")]}if(null!==c){const e=v.add(a*c,"month");return d?[e,m]:[e.startOf("month"),e.endOf("month")]}if(null!==p){const e=v.add(a*p,"week");return n?d?[e,m]:[e.startOf("week").add(1,"day"),e.endOf("week").add(1,"day")]:d?[e,m]:[e.startOf("week"),d?v:e.endOf("week")]}return null!==f?a>0?d?[v.startOf("day"),v.add(f,"day").endOf("day")]:[v.add(1,"day").startOf("day"),v.add(f,"day").endOf("day")]:d?[v.subtract(f,"day").startOf("day"),v.startOf("day")]:[v.subtract(f,"day").startOf("day"),v.subtract(1,"day").endOf("day")]:null}({s:n,now:o,mondayFirst:s,timezone:a});if(e)return e.map((e=>Yi({date:e.toDate(),typeOptions:d,isGpuDatetime:l})))}if(u===fi.inRange||u===fi.notInRange){if(!n)return;return(c=String(n))?di()(c.split(","),3).reduce(((e,i)=>{const t={key:i[0],values:[oi()(i[1]),oi()(i[2])]};return e.push(t),e}),[]):[]}var c;return i.number?+n:i.datetime?Yi({date:n,typeOptions:d}):i.related?Hi(n):i.lookup?Zi(n,d):String(Ji(n)).toLowerCase()}class et{constructor(e,i){this.filter=null!==e&&void 0!==e?e:void 0,this.useGPU=(null===i||void 0===i?void 0:i.isGpuDatetime)||!1,this.mondayFirst=(null===i||void 0===i?void 0:i.mondayFirst)||!1,this.timezone=null===i||void 0===i?void 0:i.timezone,this.now=null===i||void 0===i?void 0:i.now,this.isLngLat=null===i||void 0===i?void 0:i.isLngLat,null!==i&&void 0!==i&&i.skipCache||(this.weakmap=new WeakMap)}format(e,i){const{is:t,formatCell:n,formattedValue:o}=this.cached(e);return{is:t,formattedCell:n(i),formattedValue:o}}cached(e){var i,t;if(this.weakmap){const i=this.weakmap.get(e);if(i)return i}const n=e.op.key,o=e.field,l="value"===e.comparing,r=o.typeOptions,a="lookup"===o.type;const d=function(e){return"formula"===e.type}(o),s=Ri(o),u={user:ji(o),number:Bi(o),datetime:qi(o),choice:(c=o,!!c&&("singleChoice"===c.type||"multiChoice"===c.type)),related:Gi(o),lookup:a||d,lookupUser:a&&["member","creator","updater"].includes(null!==(i=null===r||void 0===r?void 0:r.lookupColumnType)&&void 0!==i?i:""),lookupChoice:a&&["multiChoice","singleChoice"].includes(null!==(t=null===r||void 0===r?void 0:r.lookupColumnType)&&void 0!==t?t:"")||s};var c;const p=$i(e,u,{useGPU:this.useGPU,now:this.now,timezone:this.timezone,mondayFirst:this.mondayFirst}),f=n===fi.equals&&"boolean"===o.type,v={is:u,formattedValue:p,formatCell:e=>{if(null==e)return f?"false":e;const i=u.user?String(null===e||void 0===e?void 0:e.id):u.number?+e:u.datetime?Yi({date:e,typeOptions:r,isGpuDatetime:this.useGPU}):u.related?Hi(e):u.lookup?Zi(e,r,this.useGPU):String(Ji(e)).toLowerCase();if(l&&(u.choice||u.lookupChoice)){var t;const i=(null===r||void 0===r?void 0:r.choices)||(null===r||void 0===r||null===(t=r.lookupColumnTypeOptions)||void 0===t?void 0:t.choices)||[];return String(ti()(e).map((e=>{var t;return null===(t=i.find((i=>i.id===e)))||void 0===t?void 0:t.name}))).toLowerCase()}return i}};return this.weakmap&&this.weakmap.set(e,v),v}test(e,i,t){const n=i||this.filter;return!n||be.test(n,(i=>{if(!i.field||!i.op)return!0;let n=e[i.field.id];if(this.isLngLat&&t){const o=e[t];o&&(n="POINT(".concat(n," ").concat(o,")"),Object.assign(i.field,{type:"coordinate"}))}const{is:o,formattedValue:l,formattedCell:r}=this.format(i,n);return Xi(r,o,i.op.key,l)}))}}(0,si.kP)(ui.Q,12);function it(e,i){if(!i)return;const t=e[i.id];if(!t)return 0;const n=Yi({date:t,typeOptions:i.typeOptions});return isNaN(n)?0:n/ci}function tt(e){let i=0;for(let t=0;t<e.length;t++){i=(i<<5)-i+e.charCodeAt(t),i|=0}return Math.abs(i)}const nt=["pointLinePolygon","heatmap","odLine","cluster","icon"];function ot(e){return"Circle"===e.type?{type:"Point",coordinates:[e.coordinates[0],e.coordinates[1]]}:"MultiCircle"===e.type?{type:"MultiPoint",coordinates:e.coordinates.map((e=>e.slice(0,2)))}:e}var lt=t(81659),rt=t.n(lt),at=t(82959),dt=t.n(at);function st(e){let{columns:i,cells:t,labelFieldIDs:n=[],items:o,timezone:l,members:r}=e;const a=[],d=[];return null===n||void 0===n||n.forEach(((e,n)=>{var s,u,c,f,v,m,h,y,g;const b=i instanceof Map?i.get(e):i.find((i=>i.id===e)),I=null===o||void 0===o||null===(s=o[n])||void 0===s?void 0:s.hiddenLabel,C=null===o||void 0===o||null===(u=o[n])||void 0===u?void 0:u.hiddenTooltip;if(!b)return;const k=rt()(vi.P,"number"===(null===b||void 0===b?void 0:b.type)||"lookup"===(null===b||void 0===b?void 0:b.type)?null===b||void 0===b||null===(c=b.typeOptions)||void 0===c?void 0:c.precision:null===b||void 0===b||null===(f=b.typeOptions)||void 0===f?void 0:f.numberPrecision,"number"===(null===b||void 0===b?void 0:b.type)||"lookup"===(null===b||void 0===b?void 0:b.type)?null===b||void 0===b||null===(v=b.typeOptions)||void 0===v?void 0:v.format:null===b||void 0===b||null===(m=b.typeOptions)||void 0===m?void 0:m.numberFormat,"currency"===(null===b||void 0===b||null===(h=b.typeOptions)||void 0===h?void 0:h.format)?null===b||void 0===b||null===(y=b.typeOptions)||void 0===y?void 0:y.numberPrefix:void 0);let D=null===t||void 0===t?void 0:t[b.id];const F=b.name;switch("formula"===b.type?null===(g=b.typeOptions)||void 0===g?void 0:g.expectedType:b.type){case"singleChoice":case"multiChoice":D=Wi(D,b);break;case"datetime":case"createTime":case"updateTime":D=null==D?"":Si(D,b.typeOptions,l);break;case"lookup":Ei(b)||(D=Wi(D,b,r,l));break;case"member":case"creator":case"updater":D=Wi(D,b,r)}var w,M;(D=Bi(b)&&p()(D)?k(oi()(D)):D,C)||d.push("".concat(F,": ").concat(null!==(w=D)&&void 0!==w?w:""));I||a.push(null!==(M=D)&&void 0!==M?M:"")})),{label:dt()(a).length>0?a.join("\n"):"",tooltip:dt()(d).length>0?d.join("\n"):""}}const ut=globalThis;function ct(e){return e&&Ne()(e)?e.join(","):e}function pt(e,i){return i&&Li(i)&&Array.isArray(e)&&e.length?e[0]:e}function ft(e){if(!Array.isArray(e))return"";const i=(0,o.rS)(e[0]);return Array.isArray(i)?"POINT(".concat(i[1],"  ").concat(i[0],")"):""}function vt(e,i,t,n,o){if(!e||!i||!t||!o)return;let l=Number.MAX_SAFE_INTEGER,r=0,a=[];a=De()(we()(null===o||void 0===o?void 0:o.rows,(t=>!Oe()(t.cells[i])&&!Oe()(t.cells[e]))),(i=>{const t=parseFloat(i.cells[e]);return l=t<l?t:l,r=t>r?t:r,t}));const d="quantize"===n?[l,r]:a;return"quantize"===n?(0,m.Z)().domain(d).range(t):(0,h.Z)().domain(d).range(t)}ut.onmessage=e=>{const{messageId:i,layerNodes:t=[],previewMapInfos:n,tableNodes:o,timelines:l,timezone:a,members:s,zIndexMap:c,layerFilters:f,projectTableNodes:m,isThirdPartyTable:h,thirdPartyInfoWindowCloseWay:y,resolution:g,mondayFirst:b,locale:I,adminBoundaryData:C,regionLayerMemoryCache:k}=e.data,D=new Set;Promise.allSettled(null===t||void 0===t?void 0:t.filter((e=>"map"===e.type)).map((async e=>{var i,t,F,w,M,O,T,N;let S=[],P=null;const E=n[e.id],L=(null===(i=e.mapInfo)||void 0===i?void 0:i.vectorTile)||!1,B=!(null===(t=e.vtInfo)||void 0===t||!t.publicLayer),x={...d()(E||e.mapInfo),vectorTile:L},A=null===C||void 0===C?void 0:C.find((i=>i.layerNodeId===e.id)),R=null===x||void 0===x?void 0:x.tableNodeID,q=null===o||void 0===o?void 0:o.find((e=>e.id===R)),G=null!==(F=null===q||void 0===q?void 0:q.type)&&void 0!==F?F:null===m||void 0===m||null===(w=m.find((e=>e.id===R)))||void 0===w?void 0:w.type,j=L?null===(M=e.vtInfo)||void 0===M?void 0:M.columns:null===q||void 0===q?void 0:q.columns,z=new Map(null===j||void 0===j?void 0:j.map((e=>[e.id,e]))),W=null!==x&&void 0!==x&&x.fillFieldID?z.get(x.fillFieldID):void 0,_=null!==x&&void 0!==x&&x.bivariateFillFieldID?z.get(x.bivariateFillFieldID):void 0,V=null!==x&&void 0!==x&&x.outlineFieldID?z.get(x.outlineFieldID):void 0,U=null!==x&&void 0!==x&&x.outlineWidthFieldID?z.get(x.outlineWidthFieldID):void 0,Y=null!==x&&void 0!==x&&x.radiusFieldID?z.get(x.radiusFieldID):void 0,H=null!==x&&void 0!==x&&x.heightFieldID?z.get(x.heightFieldID):void 0,Z=f[e.id]||{};if(Ri(W)&&W){var J,K;const e=(null===(J=W.typeOptions)||void 0===J?void 0:J.choices)||(null===(K=W.typeOptions)||void 0===K||null===(K=K.lookupColumnTypeOptions)||void 0===K?void 0:K.choices)||[];x.fillConfig={...x.fillConfig,_ordinalDomain:e.map((e=>e.id)),_ordinalColors:e.map((e=>null==e.color.id?ee[e.color]:e.color.bgColor))}}if(Ri(V)&&V){var Q,X;const e=(null===(Q=V.typeOptions)||void 0===Q?void 0:Q.choices)||(null===(X=V.typeOptions)||void 0===X||null===(X=X.lookupColumnTypeOptions)||void 0===X?void 0:X.choices)||[];x.outlineConfig={...x.outlineConfig,_ordinalDomain:e.map((e=>e.id)),_ordinalColors:e.map((e=>null==e.color.id?ee[e.color]:e.color.bgColor))}}const $=null===l||void 0===l?void 0:l.find((i=>i.id===e.id)),ie=null!==$&&void 0!==$&&$.columnId?z.get($.columnId):void 0;if(L)x.fillConfig={...x.fillConfig,_quantiles:(0,Ce.yK)(W,e.vtInfo,g),_uniqDomain:(0,Ce.fi)(W,e.vtInfo)},x.bivariateFillConfig={...x.bivariateFillConfig,_quantiles:(0,Ce.yK)(_,e.vtInfo,g)},x.outlineConfig={...x.outlineConfig,_quantiles:(0,Ce.yK)(V,e.vtInfo,g),_uniqDomain:(0,Ce.fi)(V,e.vtInfo),_widthFiledQuantiles:(0,Ce.yK)(U,e.vtInfo,g)},x.radiusConfig={...x.radiusConfig,_quantiles:(0,Ce.yK)(Y,e.vtInfo,g)},x.heightConfig&&(x.heightConfig={...x.heightConfig,_quantiles:(0,Ce.yK)(H,e.vtInfo,g)});else if("table"===G){const i=await async function(e){let{layer:i,tableNode:t,hiddenPoiIds:n,mapInfo:o,columns:l,filter:a,timelineColumn:d,members:s,timezone:c,filterRowsByView:f,mondayFirst:m,fillFieldScale:h,adminBoundary:y,locale:g="zh-CN",regionLayerMemoryCache:b}=e;if(!t)return{features:[],hiddenPoiIds:n};const I=function(e,i,t){if(!t)return e.rows;if(i){var n;const t=null===(n=e.views)||void 0===n?void 0:n.find((e=>e.id===i));if(null!==t&&void 0!==t&&t.rows){var o;const i=De()(t.rows,(e=>e.id));return null===(o=e.rows)||void 0===o?void 0:o.filter((e=>i.includes(e.id)))}return e.rows}return e.rows}(t,o.viewID,f);if(null===I||void 0===I||!I.length)return{features:[],hiddenPoiIds:n};const C=null!==o&&void 0!==o&&o.coordinateFieldID?l.get(o.coordinateFieldID):void 0,k=null!==o&&void 0!==o&&o.latitudeFieldID?l.get(o.latitudeFieldID):void 0,D=null!==o&&void 0!==o&&o.fillFieldID?l.get(o.fillFieldID):void 0,F=null!==o&&void 0!==o&&o.destinationFieldID?l.get(o.destinationFieldID):void 0,w=null!==o&&void 0!==o&&o.destLatitudeFieldID?l.get(o.destLatitudeFieldID):void 0,M=null!==o&&void 0!==o&&o.heightFieldID?l.get(o.heightFieldID):void 0,O=null!==o&&void 0!==o&&o.bivariateFillFieldID?l.get(o.bivariateFillFieldID):void 0,T=null!==o&&void 0!==o&&o.outlineWidthFieldID?l.get(o.outlineWidthFieldID):void 0,N=null!==o&&void 0!==o&&o.radiusFieldID?l.get(o.radiusFieldID):void 0,S=null!==o&&void 0!==o&&o.weightFieldID?l.get(o.weightFieldID):void 0,P=null!==o&&void 0!==o&&o.outlineFieldID?l.get(o.outlineFieldID):void 0;let E;l.forEach((e=>{e.isPrimary&&(E=e)}));const L=[],B="h3"===o.layerType,x="icon"===o.layerType;let A=[];const R=a.view,q=be.and(...[a.row,a.layer,a.legend,a.extension,a.arbitrary].filter(Boolean)),G=new et(R,{mondayFirst:m,timezone:c}),j=new et(q,{mondayFirst:m,timezone:c}),z=Array.from(l.values());if("region"===o.layerType){const e=null===b||void 0===b?void 0:b[function(e,i){const{regionDimensionFieldID:t,regionIndexStatsFieldID:n,specifyByFieldID:o}=i,{hideEmpty:l,dimension:r,regionId:a,aggregateBy:d,indexStatsMethod:s}=i.regionConfig;return JSON.stringify({layerNodeID:e,regionId:null!==a&&void 0!==a?a:"",regionDimensionFieldID:null!==t&&void 0!==t?t:"",regionIndexStatsFieldID:null!==n&&void 0!==n?n:"",specifyByFieldID:null!==o&&void 0!==o?o:"",hideEmpty:null!==l&&void 0!==l?l:"",dimension:null!==r&&void 0!==r?r:"",aggregateBy:null!==d&&void 0!==d?d:"",indexStatsMethod:null!==s&&void 0!==s?s:""})}(i.id,o)];if(e)return e;if(!y||!y.data)return{features:[],hiddenPoiIds:n};const l=I.filter((e=>G.test(e.cells)&&j.test(e.cells))),{hideEmpty:r}=o.regionConfig;try{var W,_;const e=await ei({locale:g,mapInfo:o,tableNode:{...t,rows:l},geojson:y.data,allIndexOptions:y.index}),i=r?null===(W=e.computingGeoJSON)||void 0===W?void 0:W.features.filter((e=>{var i;return!v()(null===(i=e.properties)||void 0===i?void 0:i.aggregationValue)})):null===(_=e.computingGeoJSON)||void 0===_?void 0:_.features;return{features:null!==i&&void 0!==i?i:[],hiddenPoiIds:n,regionMatchResult:{notMatchedItems:e.notMatchedItems,totalItems:e.totalItems}}}catch(Q){return{features:[],hiddenPoiIds:n}}}if(x&&D&&(xi(D)||zi(D))){const e=D.id,i=new Set;for(let t=0,n=I.length;t<n;t++)i.add(ct(I[t].cells[e]));A=Array.from(i).filter((e=>e)).sort(((e,i)=>e.length!==i.length?e.length-i.length:e.localeCompare(i,g)))}for(let r=0;r<I.length;r++){const e=I[r],a=it(e.cells,d);if(-1===(G.test(e.cells)?1:-1))continue;const f=j.test(e.cells)?1:-1;if(-1===f&&(n.add(e.id),!nt.includes(o.layerType)))continue;let v=pt(e.cells[null===C||void 0===C?void 0:C.id],C);if(!v)continue;if(k){const i=pt(e.cells[null===k||void 0===k?void 0:k.id],k);if(!i||!p()(i)||!p()(v))continue;v="POINT(".concat(v," ").concat(i,")")}let m=F?pt(e.cells[F.id],F):void 0;if(m&&w){const i=pt(e.cells[null===w||void 0===w?void 0:w.id],w);m=i&&p()(i)&&p()(m)?"POINT(".concat(m," ").concat(i,")"):void 0}try{var V,U,Y,H;const n=B?Array.isArray(v)?v:[v]:void 0,r=ye(B?ft(n):v),d="Circle"===(null===r||void 0===r?void 0:r.type);let p="0";if(x&&D){if(Ri(D)&&(p=e.cells[D.id]),Ai(D)&&o.fillConfig.fillMethod&&h){var Z;const i=e.cells[D.id],t=!Oe()(i)&&h?h(i):"";p=null===(Z=o.fillConfig.colors)||void 0===Z?void 0:Z.indexOf(t)}if(xi(D)||zi(D)){var J,K;const i=ct(e.cells[D.id]),t=A.indexOf(i);p=null===(J=o.fillConfig.colors)||void 0===J?void 0:J.indexOf(null===(K=o.fillConfig.colors)||void 0===K?void 0:K[t])}}const y=E?e.cells[E.id]:"",{label:g,tooltip:b}=st({columns:l,cells:e.cells,labelFieldIDs:o.labelFieldID?[o.labelFieldID].concat(null!==(V=o.extraLabelFieldIDs)&&void 0!==V?V:[]):[],items:null===(U=o.labelConfig)||void 0===U?void 0:U.items,timezone:c,members:s}),I={type:"Feature",geometry:ot(r),properties:u()({id:e.id,name:g||y,tooltip:b,tableNodeType:t.type,hexIds:n,["".concat(null===o||void 0===o?void 0:o.labelFieldID,"-labelFieldID")]:g,[null===o||void 0===o?void 0:o.fillFieldID]:pt(e.cells[null===o||void 0===o?void 0:o.fillFieldID],D),[null===o||void 0===o?void 0:o.bivariateFillFieldID]:pt(e.cells[null===o||void 0===o?void 0:o.bivariateFillFieldID],O),[null===o||void 0===o?void 0:o.radiusFieldID]:pt(e.cells[null===o||void 0===o?void 0:o.radiusFieldID],N),[o.outlineFieldID]:pt(e.cells[o.outlineFieldID],P),[null===o||void 0===o?void 0:o.outlineWidthFieldID]:pt(e.cells[null===o||void 0===o?void 0:o.outlineWidthFieldID],T),[null===o||void 0===o?void 0:o.weightFieldID]:pt(e.cells[null===o||void 0===o?void 0:o.weightFieldID],S),[null===o||void 0===o?void 0:o.destinationFieldID]:m?ye(m):void 0,[null===o||void 0===o?void 0:o.heightFieldID]:pt(e.cells[null===o||void 0===o?void 0:o.heightFieldID],M),[o.timestampFieldID]:e.cells[o.timestampFieldID],[null===o||void 0===o?void 0:o.groupByFieldID]:e.cells[null===o||void 0===o?void 0:o.groupByFieldID],[null===o||void 0===o?void 0:o.sortByFieldID]:e.cells[null===o||void 0===o?void 0:o.sortByFieldID],tableNodeID:null===t||void 0===t?void 0:t.id,rowID:e.id,cellID:null===o||void 0===o?void 0:o.coordinateFieldID,latCellID:null===o||void 0===o?void 0:o.latitudeFieldID,subscribed:"subscribed"===(null===C||void 0===C?void 0:C.mode)||"connected"===(null===C||void 0===C?void 0:C.mode),editable:"coordinate"===(null===C||void 0===C?void 0:C.type)||"number"===(null===C||void 0===C?void 0:C.type),layerID:i.id,labelFieldID:null===o||void 0===o?void 0:o.labelFieldID,filterValue:f,timelineValue:a,radius:d?null===r||void 0===r?void 0:r.coordinates[2]:void 0,choicesId:p,fillFieldName:null===D||void 0===D?void 0:D.name,fillFieldID:null===D||void 0===D?void 0:D.id,fillAggregateBy:o.fillConfig.aggregateBy,enableHeight:null===(Y=o.heightConfig)||void 0===Y?void 0:Y.toggle,heightFieldName:null===M||void 0===M?void 0:M.name,heightFieldID:null===M||void 0===M?void 0:M.id,heightAggregateBy:null===(H=o.heightConfig)||void 0===H?void 0:H.aggregateBy,rawCells:e.cells,rawColumns:z},((e,i)=>null==i))};L.push(I)}catch(Q){console.error(Q)}}o.timestampFieldID&&L.sort(((e,i)=>{var t,n;const l=null===(t=e.properties)||void 0===t?void 0:t[o.timestampFieldID],a=null===(n=i.properties)||void 0===n?void 0:n[o.timestampFieldID];return l&&a?r()(l).valueOf()-r()(a).valueOf():0}));return{features:L,hiddenPoiIds:n}}({layer:e,columns:z,hiddenPoiIds:D,tableNode:q,mapInfo:x,filter:Z,timelineColumn:ie,members:s,timezone:a,mondayFirst:b,locale:I,filterRowsByView:h,fillFieldScale:vt(x.fillFieldID,x.coordinateFieldID,x.fillConfig.colors,x.fillConfig.fillMethod,q),adminBoundary:A,regionLayerMemoryCache:k});S=i.features,P=i.regionMatchResult,W&&(xi(W)||zi(W))&&(x.fillConfig={...x.fillConfig,_uniqDomain:(0,Ce.uT)(S,W.id)}),V&&(xi(V)||zi(V))&&(x.outlineConfig={...x.outlineConfig,_uniqDomain:(0,Ce.uT)(S,V.id)}),null!==q&&void 0!==q&&q.domain&&h&&(x.fillConfig={...x.fillConfig,_domain:q.domain})}const te=B?null===(O=e.vtInfo)||void 0===O||null===(O=O.infoWindowConfig)||void 0===O?void 0:O.closeWay:R?null===m||void 0===m||null===(T=m.find((e=>e.id===R)))||void 0===T||null===(T=T.infoWindowConfig)||void 0===T?void 0:T.closeWay:void 0,ne=h?y:te;return{tableNodeId:R,tableNodeType:G,tableNodeUpdatedAt:null===q||void 0===q?void 0:q.lastUpdatedAt,type:"FeatureCollection",features:S,id:e.id,name:e.name,zIndex:null!==(N=c[e.id])&&void 0!==N?N:-e.order,mapInfo:x,vtInfo:e.vtInfo,timelineColumn:ie,columns:j,members:s,timezone:a,layerFilter:Z,infoWindowCloseWay:ne,isPreview:!!E,regionMatchResult:P}}))).then((e=>e.map((e=>"rejected"===e.status?(console.error(e.reason),null):e.value)).filter((e=>e)))).then((e=>e.sort(((e,i)=>{var t,n;return(null!==(t=e.zIndex)&&void 0!==t?t:0)-(null!==(n=i.zIndex)&&void 0!==n?n:0)})))).then((e=>{ut.postMessage({messageId:i,computedLayers:e,hiddenPois:D})})).catch((e=>{console.error("Error processing layers:",e),ut.postMessage({messageId:i,computedLayers:[],hiddenPois:D})}))}}},i={};function t(n){var o=i[n];if(void 0!==o)return o.exports;var l=i[n]={id:n,loaded:!1,exports:{}};return e[n].call(l.exports,l,l.exports,t),l.loaded=!0,l.exports}t.m=e,t.x=()=>{var e=t.O(void 0,[638,790,190,698,21,253,911,298],(()=>t(3669)));return e=t.O(e)},(()=>{var e=[];t.O=(i,n,o,l)=>{if(!n){var r=1/0;for(u=0;u<e.length;u++){n=e[u][0],o=e[u][1],l=e[u][2];for(var a=!0,d=0;d<n.length;d++)(!1&l||r>=l)&&Object.keys(t.O).every((e=>t.O[e](n[d])))?n.splice(d--,1):(a=!1,l<r&&(r=l));if(a){e.splice(u--,1);var s=o();void 0!==s&&(i=s)}}return i}l=l||0;for(var u=e.length;u>0&&e[u-1][2]>l;u--)e[u]=e[u-1];e[u]=[n,o,l]}})(),t.n=e=>{var i=e&&e.__esModule?()=>e.default:()=>e;return t.d(i,{a:i}),i},(()=>{var e,i=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;t.t=function(n,o){if(1&o&&(n=this(n)),8&o)return n;if("object"===typeof n&&n){if(4&o&&n.__esModule)return n;if(16&o&&"function"===typeof n.then)return n}var l=Object.create(null);t.r(l);var r={};e=e||[null,i({}),i([]),i(i)];for(var a=2&o&&n;"object"==typeof a&&!~e.indexOf(a);a=i(a))Object.getOwnPropertyNames(a).forEach((e=>r[e]=()=>n[e]));return r.default=()=>n,t.d(l,r),l}})(),t.d=(e,i)=>{for(var n in i)t.o(i,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:i[n]})},t.f={},t.e=e=>Promise.all(Object.keys(t.f).reduce(((i,n)=>(t.f[n](e,i),i)),[])),t.u=e=>638===e?"static/js/638.48b925df.js":790===e?"static/js/790.9bc4fae2.js":190===e?"static/js/190.8bd7f8f0.js":21===e?"static/js/21.742a186e.js":"static/js/"+({101:"lang-en-m",113:"lang-zh-CN",615:"lang-ja-JP",628:"lang-ja-JP-m",658:"lang-zh-CN-m",695:"lang-en"}[e]||e)+"."+{101:"b5575228",113:"95225bb4",253:"92fe4cea",298:"b6f297c7",615:"a7de3377",628:"020f714d",658:"80568ddc",695:"048feda4",698:"4d2febf4",911:"c6bbc63d"}[e]+".chunk.js",t.miniCssF=e=>{},t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),t.o=(e,i)=>Object.prototype.hasOwnProperty.call(e,i),t.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),t.p="./",(()=>{var e={995:1};t.f.i=(i,n)=>{e[i]||importScripts(t.p+t.u(i))};var i=self.webpackChunkmaptable_frontend=self.webpackChunkmaptable_frontend||[],n=i.push.bind(i);i.push=i=>{var o=i[0],l=i[1],r=i[2];for(var a in l)t.o(l,a)&&(t.m[a]=l[a]);for(r&&r(t);o.length;)e[o.pop()]=1;n(i)}})(),(()=>{var e=t.x;t.x=()=>Promise.all([638,790,190,698,21,253,911,298].map(t.e,t)).then(e)})();t.x()})();